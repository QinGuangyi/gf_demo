<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title></title>
  <style>
  @font-face {
  font-family: octicons-link;
  src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==) format('woff');
}

.markdown-body .octicon {
  display: inline-block;
  fill: currentColor;
  vertical-align: text-bottom;
}

.markdown-body .anchor {
  float: left;
  line-height: 1;
  margin-left: -20px;
  padding-right: 4px;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  color: #1b1f23;
  vertical-align: middle;
  visibility: hidden;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  visibility: visible;
}

.markdown-body {
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #24292e;
  line-height: 1.5;
  font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;
  font-size: 16px;
  line-height: 1.5;
  word-wrap: break-word;
}

.markdown-body .pl-c {
  color: #6a737d;
}

.markdown-body .pl-c1,
.markdown-body .pl-s .pl-v {
  color: #005cc5;
}

.markdown-body .pl-e,
.markdown-body .pl-en {
  color: #6f42c1;
}

.markdown-body .pl-s .pl-s1,
.markdown-body .pl-smi {
  color: #24292e;
}

.markdown-body .pl-ent {
  color: #22863a;
}

.markdown-body .pl-k {
  color: #d73a49;
}

.markdown-body .pl-pds,
.markdown-body .pl-s,
.markdown-body .pl-s .pl-pse .pl-s1,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sra,
.markdown-body .pl-sr .pl-sre {
  color: #032f62;
}

.markdown-body .pl-smw,
.markdown-body .pl-v {
  color: #e36209;
}

.markdown-body .pl-bu {
  color: #b31d28;
}

.markdown-body .pl-ii {
  background-color: #b31d28;
  color: #fafbfc;
}

.markdown-body .pl-c2 {
  background-color: #d73a49;
  color: #fafbfc;
}

.markdown-body .pl-c2:before {
  content: "^M";
}

.markdown-body .pl-sr .pl-cce {
  color: #22863a;
  font-weight: 700;
}

.markdown-body .pl-ml {
  color: #735c0f;
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
  color: #005cc5;
  font-weight: 700;
}

.markdown-body .pl-mi {
  color: #24292e;
  font-style: italic;
}

.markdown-body .pl-mb {
  color: #24292e;
  font-weight: 700;
}

.markdown-body .pl-md {
  background-color: #ffeef0;
  color: #b31d28;
}

.markdown-body .pl-mi1 {
  background-color: #f0fff4;
  color: #22863a;
}

.markdown-body .pl-mc {
  background-color: #ffebda;
  color: #e36209;
}

.markdown-body .pl-mi2 {
  background-color: #005cc5;
  color: #f6f8fa;
}

.markdown-body .pl-mdr {
  color: #6f42c1;
  font-weight: 700;
}

.markdown-body .pl-ba {
  color: #586069;
}

.markdown-body .pl-sg {
  color: #959da5;
}

.markdown-body .pl-corl {
  color: #032f62;
  text-decoration: underline;
}

.markdown-body details {
  display: block;
}

.markdown-body summary {
  display: list-item;
}

.markdown-body a {
  background-color: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline-width: 0;
}

.markdown-body strong {
  font-weight: inherit;
  font-weight: bolder;
}

.markdown-body h1 {
  font-size: 2em;
  margin: .67em 0;
}

.markdown-body img {
  border-style: none;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre {
  font-family: monospace,monospace;
  font-size: 1em;
}

.markdown-body hr {
  box-sizing: content-box;
  height: 0;
  overflow: visible;
}

.markdown-body input {
  font: inherit;
  margin: 0;
}

.markdown-body input {
  overflow: visible;
}

.markdown-body [type=checkbox] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body * {
  box-sizing: border-box;
}

.markdown-body input {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

.markdown-body a {
  color: #0366d6;
  text-decoration: none;
}

.markdown-body a:hover {
  text-decoration: underline;
}

.markdown-body strong {
  font-weight: 600;
}

.markdown-body hr {
  background: transparent;
  border: 0;
  border-bottom: 1px solid #dfe2e5;
  height: 0;
  margin: 15px 0;
  overflow: hidden;
}

.markdown-body hr:before {
  content: "";
  display: table;
}

.markdown-body hr:after {
  clear: both;
  content: "";
  display: table;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body details summary {
  cursor: pointer;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body h1 {
  font-size: 32px;
}

.markdown-body h1,
.markdown-body h2 {
  font-weight: 600;
}

.markdown-body h2 {
  font-size: 24px;
}

.markdown-body h3 {
  font-size: 20px;
}

.markdown-body h3,
.markdown-body h4 {
  font-weight: 600;
}

.markdown-body h4 {
  font-size: 16px;
}

.markdown-body h5 {
  font-size: 14px;
}

.markdown-body h5,
.markdown-body h6 {
  font-weight: 600;
}

.markdown-body h6 {
  font-size: 12px;
}

.markdown-body p {
  margin-bottom: 10px;
  margin-top: 0;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ol,
.markdown-body ul {
  margin-bottom: 0;
  margin-top: 0;
  padding-left: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ol ol ol,
.markdown-body ol ul ol,
.markdown-body ul ol ol,
.markdown-body ul ul ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre {
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body input::-webkit-inner-spin-button,
.markdown-body input::-webkit-outer-spin-button {
  -webkit-appearance: none;
  appearance: none;
  margin: 0;
}

.markdown-body .border {
  border: 1px solid #e1e4e8!important;
}

.markdown-body .border-0 {
  border: 0!important;
}

.markdown-body .border-bottom {
  border-bottom: 1px solid #e1e4e8!important;
}

.markdown-body .rounded-1 {
  border-radius: 3px!important;
}

.markdown-body .bg-white {
  background-color: #fff!important;
}

.markdown-body .bg-gray-light {
  background-color: #fafbfc!important;
}

.markdown-body .text-gray-light {
  color: #6a737d!important;
}

.markdown-body .mb-0 {
  margin-bottom: 0!important;
}

.markdown-body .my-2 {
  margin-bottom: 8px!important;
  margin-top: 8px!important;
}

.markdown-body .pl-0 {
  padding-left: 0!important;
}

.markdown-body .py-0 {
  padding-bottom: 0!important;
  padding-top: 0!important;
}

.markdown-body .pl-1 {
  padding-left: 4px!important;
}

.markdown-body .pl-2 {
  padding-left: 8px!important;
}

.markdown-body .py-2 {
  padding-bottom: 8px!important;
  padding-top: 8px!important;
}

.markdown-body .pl-3,
.markdown-body .px-3 {
  padding-left: 16px!important;
}

.markdown-body .px-3 {
  padding-right: 16px!important;
}

.markdown-body .pl-4 {
  padding-left: 24px!important;
}

.markdown-body .pl-5 {
  padding-left: 32px!important;
}

.markdown-body .pl-6 {
  padding-left: 40px!important;
}

.markdown-body .f6 {
  font-size: 12px!important;
}

.markdown-body .lh-condensed {
  line-height: 1.25!important;
}

.markdown-body .text-bold {
  font-weight: 600!important;
}

.markdown-body:before {
  content: "";
  display: table;
}

.markdown-body:after {
  clear: both;
  content: "";
  display: table;
}

.markdown-body>:first-child {
  margin-top: 0!important;
}

.markdown-body>:last-child {
  margin-bottom: 0!important;
}

.markdown-body a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.markdown-body blockquote,
.markdown-body dl,
.markdown-body ol,
.markdown-body p,
.markdown-body pre,
.markdown-body table,
.markdown-body ul {
  margin-bottom: 16px;
  margin-top: 0;
}

.markdown-body hr {
  background-color: #e1e4e8;
  border: 0;
  height: .25em;
  margin: 24px 0;
  padding: 0;
}

.markdown-body blockquote {
  border-left: .25em solid #dfe2e5;
  color: #6a737d;
  padding: 0 1em;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #fafbfc;
  border: 1px solid #c6cbd1;
  border-bottom-color: #959da5;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #959da5;
  color: #444d56;
  display: inline-block;
  font-size: 11px;
  line-height: 10px;
  padding: 3px 5px;
  vertical-align: middle;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  font-weight: 600;
  line-height: 1.25;
  margin-bottom: 16px;
  margin-top: 24px;
}

.markdown-body h1 {
  font-size: 2em;
}

.markdown-body h1,
.markdown-body h2 {
  border-bottom: 1px solid #eaecef;
  padding-bottom: .3em;
}

.markdown-body h2 {
  font-size: 1.5em;
}

.markdown-body h3 {
  font-size: 1.25em;
}

.markdown-body h4 {
  font-size: 1em;
}

.markdown-body h5 {
  font-size: .875em;
}

.markdown-body h6 {
  color: #6a737d;
  font-size: .85em;
}

.markdown-body ol,
.markdown-body ul {
  padding-left: 2em;
}

.markdown-body ol ol,
.markdown-body ol ul,
.markdown-body ul ol,
.markdown-body ul ul {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body li {
  word-wrap: break-all;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body li+li {
  margin-top: .25em;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  font-size: 1em;
  font-style: italic;
  font-weight: 600;
  margin-top: 16px;
  padding: 0;
}

.markdown-body dl dd {
  margin-bottom: 16px;
  padding: 0 16px;
}

.markdown-body table {
  display: block;
  overflow: auto;
  width: 100%;
}

.markdown-body table th {
  font-weight: 600;
}

.markdown-body table td,
.markdown-body table th {
  border: 1px solid #dfe2e5;
  padding: 6px 13px;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #c6cbd1;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f6f8fa;
}

.markdown-body img {
  background-color: #fff;
  box-sizing: content-box;
  max-width: 100%;
}

.markdown-body img[align=right] {
  padding-left: 20px;
}

.markdown-body img[align=left] {
  padding-right: 20px;
}

.markdown-body code {
  background-color: rgba(27,31,35,.05);
  border-radius: 3px;
  font-size: 85%;
  margin: 0;
  padding: .2em .4em;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre>code {
  background: transparent;
  border: 0;
  font-size: 100%;
  margin: 0;
  padding: 0;
  white-space: pre;
  word-break: normal;
}

.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body .highlight pre,
.markdown-body pre {
  background-color: #f6f8fa;
  border-radius: 3px;
  font-size: 85%;
  line-height: 1.45;
  overflow: auto;
  padding: 16px;
}

.markdown-body pre code {
  background-color: transparent;
  border: 0;
  display: inline;
  line-height: inherit;
  margin: 0;
  max-width: auto;
  overflow: visible;
  padding: 0;
  word-wrap: normal;
}

.markdown-body .commit-tease-sha {
  color: #444d56;
  display: inline-block;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 90%;
}

.markdown-body .blob-wrapper {
  border-bottom-left-radius: 3px;
  border-bottom-right-radius: 3px;
  overflow-x: auto;
  overflow-y: hidden;
}

.markdown-body .blob-wrapper-embedded {
  max-height: 240px;
  overflow-y: auto;
}

.markdown-body .blob-num {
  -moz-user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  color: rgba(27,31,35,.3);
  cursor: pointer;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
  line-height: 20px;
  min-width: 50px;
  padding-left: 10px;
  padding-right: 10px;
  text-align: right;
  user-select: none;
  vertical-align: top;
  white-space: nowrap;
  width: 1%;
}

.markdown-body .blob-num:hover {
  color: rgba(27,31,35,.6);
}

.markdown-body .blob-num:before {
  content: attr(data-line-number);
}

.markdown-body .blob-code {
  line-height: 20px;
  padding-left: 10px;
  padding-right: 10px;
  position: relative;
  vertical-align: top;
}

.markdown-body .blob-code-inner {
  color: #24292e;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
  overflow: visible;
  white-space: pre;
  word-wrap: normal;
}

.markdown-body .pl-token.active,
.markdown-body .pl-token:hover {
  background: #ffea7f;
  cursor: pointer;
}

.markdown-body kbd {
  background-color: #fafbfc;
  border: 1px solid #d1d5da;
  border-bottom-color: #c6cbd1;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #c6cbd1;
  color: #444d56;
  display: inline-block;
  font: 11px SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  line-height: 10px;
  padding: 3px 5px;
  vertical-align: middle;
}

.markdown-body :checked+.radio-label {
  border-color: #0366d6;
  position: relative;
  z-index: 1;
}

.markdown-body .tab-size[data-tab-size="1"] {
  -moz-tab-size: 1;
  tab-size: 1;
}

.markdown-body .tab-size[data-tab-size="2"] {
  -moz-tab-size: 2;
  tab-size: 2;
}

.markdown-body .tab-size[data-tab-size="3"] {
  -moz-tab-size: 3;
  tab-size: 3;
}

.markdown-body .tab-size[data-tab-size="4"] {
  -moz-tab-size: 4;
  tab-size: 4;
}

.markdown-body .tab-size[data-tab-size="5"] {
  -moz-tab-size: 5;
  tab-size: 5;
}

.markdown-body .tab-size[data-tab-size="6"] {
  -moz-tab-size: 6;
  tab-size: 6;
}

.markdown-body .tab-size[data-tab-size="7"] {
  -moz-tab-size: 7;
  tab-size: 7;
}

.markdown-body .tab-size[data-tab-size="8"] {
  -moz-tab-size: 8;
  tab-size: 8;
}

.markdown-body .tab-size[data-tab-size="9"] {
  -moz-tab-size: 9;
  tab-size: 9;
}

.markdown-body .tab-size[data-tab-size="10"] {
  -moz-tab-size: 10;
  tab-size: 10;
}

.markdown-body .tab-size[data-tab-size="11"] {
  -moz-tab-size: 11;
  tab-size: 11;
}

.markdown-body .tab-size[data-tab-size="12"] {
  -moz-tab-size: 12;
  tab-size: 12;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 .2em .25em -1.6em;
  vertical-align: middle;
}

.markdown-body hr {
  border-bottom-color: #eee;
}

.markdown-body .pl-0 {
  padding-left: 0!important;
}

.markdown-body .pl-1 {
  padding-left: 4px!important;
}

.markdown-body .pl-2 {
  padding-left: 8px!important;
}

.markdown-body .pl-3 {
  padding-left: 16px!important;
}

.markdown-body .pl-4 {
  padding-left: 24px!important;
}

.markdown-body .pl-5 {
  padding-left: 32px!important;
}

.markdown-body .pl-6 {
  padding-left: 40px!important;
}

.markdown-body .pl-7 {
  padding-left: 48px!important;
}

.markdown-body .pl-8 {
  padding-left: 64px!important;
}

.markdown-body .pl-9 {
  padding-left: 80px!important;
}

.markdown-body .pl-10 {
  padding-left: 96px!important;
}

.markdown-body .pl-11 {
  padding-left: 112px!important;
}

.markdown-body .pl-12 {
  padding-left: 128px!important;
}

/*# sourceURL=webpack://./node_modules/github-markdown-css/github-markdown.css */
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL25vZGVfbW9kdWxlcy9naXRodWItbWFya2Rvd24tY3NzL2dpdGh1Yi1tYXJrZG93bi5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSwwQkFBMEI7RUFDMUIsMkRBQXF0RTtBQUN2dEU7O0FBRUE7RUFDRSxxQkFBcUI7RUFDckIsa0JBQWtCO0VBQ2xCLDJCQUEyQjtBQUM3Qjs7QUFFQTtFQUNFLFdBQVc7RUFDWCxjQUFjO0VBQ2Qsa0JBQWtCO0VBQ2xCLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLGFBQWE7QUFDZjs7QUFFQTs7Ozs7O0VBTUUsY0FBYztFQUNkLHNCQUFzQjtFQUN0QixrQkFBa0I7QUFDcEI7O0FBRUE7Ozs7OztFQU1FLHFCQUFxQjtBQUN2Qjs7QUFFQTs7Ozs7O0VBTUUsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsMEJBQTBCO0VBQzFCLDhCQUE4QjtFQUM5QixjQUFjO0VBQ2QsZ0JBQWdCO0VBQ2hCLGtJQUFrSTtFQUNsSSxlQUFlO0VBQ2YsZ0JBQWdCO0VBQ2hCLHFCQUFxQjtBQUN2Qjs7QUFFQTtFQUNFLGNBQWM7QUFDaEI7O0FBRUE7O0VBRUUsY0FBYztBQUNoQjs7QUFFQTs7RUFFRSxjQUFjO0FBQ2hCOztBQUVBOztFQUVFLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsY0FBYztBQUNoQjs7QUFFQTs7Ozs7OztFQU9FLGNBQWM7QUFDaEI7O0FBRUE7O0VBRUUsY0FBYztBQUNoQjs7QUFFQTtFQUNFLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSx5QkFBeUI7RUFDekIsY0FBYztBQUNoQjs7QUFFQTtFQUNFLHlCQUF5QjtFQUN6QixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsYUFBYTtBQUNmOztBQUVBO0VBQ0UsY0FBYztFQUNkLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLGNBQWM7QUFDaEI7O0FBRUE7OztFQUdFLGNBQWM7RUFDZCxnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxjQUFjO0VBQ2Qsa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0UsY0FBYztFQUNkLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLHlCQUF5QjtFQUN6QixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UseUJBQXlCO0VBQ3pCLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSx5QkFBeUI7RUFDekIsY0FBYztBQUNoQjs7QUFFQTtFQUNFLHlCQUF5QjtFQUN6QixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsY0FBYztFQUNkLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsY0FBYztFQUNkLDBCQUEwQjtBQUM1Qjs7QUFFQTtFQUNFLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxrQkFBa0I7QUFDcEI7O0FBRUE7RUFDRSw2QkFBNkI7QUFDL0I7O0FBRUE7O0VBRUUsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0Usb0JBQW9CO0VBQ3BCLG1CQUFtQjtBQUNyQjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxlQUFlO0FBQ2pCOztBQUVBO0VBQ0Usa0JBQWtCO0FBQ3BCOztBQUVBOzs7RUFHRSxnQ0FBZ0M7RUFDaEMsY0FBYztBQUNoQjs7QUFFQTtFQUNFLHVCQUF1QjtFQUN2QixTQUFTO0VBQ1QsaUJBQWlCO0FBQ25COztBQUVBO0VBQ0UsYUFBYTtFQUNiLFNBQVM7QUFDWDs7QUFFQTtFQUNFLGlCQUFpQjtBQUNuQjs7QUFFQTtFQUNFLHNCQUFzQjtFQUN0QixVQUFVO0FBQ1o7O0FBRUE7RUFDRSxzQkFBc0I7QUFDeEI7O0FBRUE7RUFDRSxvQkFBb0I7RUFDcEIsa0JBQWtCO0VBQ2xCLG9CQUFvQjtBQUN0Qjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxxQkFBcUI7QUFDdkI7O0FBRUE7RUFDRSwwQkFBMEI7QUFDNUI7O0FBRUE7RUFDRSxnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSx1QkFBdUI7RUFDdkIsU0FBUztFQUNULGdDQUFnQztFQUNoQyxTQUFTO0VBQ1QsY0FBYztFQUNkLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLFdBQVc7RUFDWCxjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsV0FBVztFQUNYLFdBQVc7RUFDWCxjQUFjO0FBQ2hCOztBQUVBO0VBQ0UseUJBQXlCO0VBQ3pCLGlCQUFpQjtBQUNuQjs7QUFFQTs7RUFFRSxVQUFVO0FBQ1o7O0FBRUE7RUFDRSxlQUFlO0FBQ2pCOztBQUVBOzs7Ozs7RUFNRSxnQkFBZ0I7RUFDaEIsYUFBYTtBQUNmOztBQUVBO0VBQ0UsZUFBZTtBQUNqQjs7QUFFQTs7RUFFRSxnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsZUFBZTtBQUNqQjs7QUFFQTs7RUFFRSxnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsZUFBZTtBQUNqQjs7QUFFQTs7RUFFRSxnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsbUJBQW1CO0VBQ25CLGFBQWE7QUFDZjs7QUFFQTtFQUNFLFNBQVM7QUFDWDs7QUFFQTs7RUFFRSxnQkFBZ0I7RUFDaEIsYUFBYTtFQUNiLGVBQWU7QUFDakI7O0FBRUE7O0VBRUUsNEJBQTRCO0FBQzlCOztBQUVBOzs7O0VBSUUsNEJBQTRCO0FBQzlCOztBQUVBO0VBQ0UsY0FBYztBQUNoQjs7QUFFQTs7RUFFRSw0RUFBNEU7RUFDNUUsZUFBZTtBQUNqQjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixhQUFhO0FBQ2Y7O0FBRUE7O0VBRUUsd0JBQXdCO0VBQ3hCLGdCQUFnQjtFQUNoQixTQUFTO0FBQ1g7O0FBRUE7RUFDRSxtQ0FBbUM7QUFDckM7O0FBRUE7RUFDRSxtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSwwQ0FBMEM7QUFDNUM7O0FBRUE7RUFDRSw0QkFBNEI7QUFDOUI7O0FBRUE7RUFDRSxnQ0FBZ0M7QUFDbEM7O0FBRUE7RUFDRSxtQ0FBbUM7QUFDckM7O0FBRUE7RUFDRSx3QkFBd0I7QUFDMUI7O0FBRUE7RUFDRSwwQkFBMEI7QUFDNUI7O0FBRUE7RUFDRSw0QkFBNEI7RUFDNUIseUJBQXlCO0FBQzNCOztBQUVBO0VBQ0UseUJBQXlCO0FBQzNCOztBQUVBO0VBQ0UsMkJBQTJCO0VBQzNCLHdCQUF3QjtBQUMxQjs7QUFFQTtFQUNFLDJCQUEyQjtBQUM3Qjs7QUFFQTtFQUNFLDJCQUEyQjtBQUM3Qjs7QUFFQTtFQUNFLDZCQUE2QjtFQUM3QiwwQkFBMEI7QUFDNUI7O0FBRUE7O0VBRUUsNEJBQTRCO0FBQzlCOztBQUVBO0VBQ0UsNkJBQTZCO0FBQy9COztBQUVBO0VBQ0UsNEJBQTRCO0FBQzlCOztBQUVBO0VBQ0UsNEJBQTRCO0FBQzlCOztBQUVBO0VBQ0UsNEJBQTRCO0FBQzlCOztBQUVBO0VBQ0UseUJBQXlCO0FBQzNCOztBQUVBO0VBQ0UsMkJBQTJCO0FBQzdCOztBQUVBO0VBQ0UsMEJBQTBCO0FBQzVCOztBQUVBO0VBQ0UsV0FBVztFQUNYLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsV0FBVztFQUNYLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSx1QkFBdUI7QUFDekI7O0FBRUE7RUFDRSwwQkFBMEI7QUFDNUI7O0FBRUE7RUFDRSxjQUFjO0VBQ2QscUJBQXFCO0FBQ3ZCOztBQUVBOzs7Ozs7O0VBT0UsbUJBQW1CO0VBQ25CLGFBQWE7QUFDZjs7QUFFQTtFQUNFLHlCQUF5QjtFQUN6QixTQUFTO0VBQ1QsYUFBYTtFQUNiLGNBQWM7RUFDZCxVQUFVO0FBQ1o7O0FBRUE7RUFDRSxnQ0FBZ0M7RUFDaEMsY0FBYztFQUNkLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxhQUFhO0FBQ2Y7O0FBRUE7RUFDRSxnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSx5QkFBeUI7RUFDekIseUJBQXlCO0VBQ3pCLDRCQUE0QjtFQUM1QixrQkFBa0I7RUFDbEIsa0NBQWtDO0VBQ2xDLGNBQWM7RUFDZCxxQkFBcUI7RUFDckIsZUFBZTtFQUNmLGlCQUFpQjtFQUNqQixnQkFBZ0I7RUFDaEIsc0JBQXNCO0FBQ3hCOztBQUVBOzs7Ozs7RUFNRSxnQkFBZ0I7RUFDaEIsaUJBQWlCO0VBQ2pCLG1CQUFtQjtFQUNuQixnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxjQUFjO0FBQ2hCOztBQUVBOztFQUVFLGdDQUFnQztFQUNoQyxvQkFBb0I7QUFDdEI7O0FBRUE7RUFDRSxnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxpQkFBaUI7QUFDbkI7O0FBRUE7RUFDRSxjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsaUJBQWlCO0FBQ25COztBQUVBO0VBQ0UsY0FBYztFQUNkLGdCQUFnQjtBQUNsQjs7QUFFQTs7RUFFRSxpQkFBaUI7QUFDbkI7O0FBRUE7Ozs7RUFJRSxnQkFBZ0I7RUFDaEIsYUFBYTtBQUNmOztBQUVBO0VBQ0Usb0JBQW9CO0FBQ3RCOztBQUVBO0VBQ0UsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0UsaUJBQWlCO0FBQ25COztBQUVBO0VBQ0UsVUFBVTtBQUNaOztBQUVBO0VBQ0UsY0FBYztFQUNkLGtCQUFrQjtFQUNsQixnQkFBZ0I7RUFDaEIsZ0JBQWdCO0VBQ2hCLFVBQVU7QUFDWjs7QUFFQTtFQUNFLG1CQUFtQjtFQUNuQixlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsY0FBYztFQUNkLGNBQWM7RUFDZCxXQUFXO0FBQ2I7O0FBRUE7RUFDRSxnQkFBZ0I7QUFDbEI7O0FBRUE7O0VBRUUseUJBQXlCO0VBQ3pCLGlCQUFpQjtBQUNuQjs7QUFFQTtFQUNFLHNCQUFzQjtFQUN0Qiw2QkFBNkI7QUFDL0I7O0FBRUE7RUFDRSx5QkFBeUI7QUFDM0I7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIsdUJBQXVCO0VBQ3ZCLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxrQkFBa0I7QUFDcEI7O0FBRUE7RUFDRSxtQkFBbUI7QUFDckI7O0FBRUE7RUFDRSxvQ0FBb0M7RUFDcEMsa0JBQWtCO0VBQ2xCLGNBQWM7RUFDZCxTQUFTO0VBQ1Qsa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0UsaUJBQWlCO0FBQ25COztBQUVBO0VBQ0UsdUJBQXVCO0VBQ3ZCLFNBQVM7RUFDVCxlQUFlO0VBQ2YsU0FBUztFQUNULFVBQVU7RUFDVixnQkFBZ0I7RUFDaEIsa0JBQWtCO0FBQ3BCOztBQUVBO0VBQ0UsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLGtCQUFrQjtBQUNwQjs7QUFFQTs7RUFFRSx5QkFBeUI7RUFDekIsa0JBQWtCO0VBQ2xCLGNBQWM7RUFDZCxpQkFBaUI7RUFDakIsY0FBYztFQUNkLGFBQWE7QUFDZjs7QUFFQTtFQUNFLDZCQUE2QjtFQUM3QixTQUFTO0VBQ1QsZUFBZTtFQUNmLG9CQUFvQjtFQUNwQixTQUFTO0VBQ1QsZUFBZTtFQUNmLGlCQUFpQjtFQUNqQixVQUFVO0VBQ1YsaUJBQWlCO0FBQ25COztBQUVBO0VBQ0UsY0FBYztFQUNkLHFCQUFxQjtFQUNyQiw0RUFBNEU7RUFDNUUsY0FBYztBQUNoQjs7QUFFQTtFQUNFLDhCQUE4QjtFQUM5QiwrQkFBK0I7RUFDL0IsZ0JBQWdCO0VBQ2hCLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLGlCQUFpQjtFQUNqQixnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxzQkFBc0I7RUFDdEIscUJBQXFCO0VBQ3JCLHlCQUF5QjtFQUN6Qix3QkFBd0I7RUFDeEIsZUFBZTtFQUNmLDRFQUE0RTtFQUM1RSxlQUFlO0VBQ2YsaUJBQWlCO0VBQ2pCLGVBQWU7RUFDZixrQkFBa0I7RUFDbEIsbUJBQW1CO0VBQ25CLGlCQUFpQjtFQUNqQixpQkFBaUI7RUFDakIsbUJBQW1CO0VBQ25CLG1CQUFtQjtFQUNuQixTQUFTO0FBQ1g7O0FBRUE7RUFDRSx3QkFBd0I7QUFDMUI7O0FBRUE7RUFDRSwrQkFBK0I7QUFDakM7O0FBRUE7RUFDRSxpQkFBaUI7RUFDakIsa0JBQWtCO0VBQ2xCLG1CQUFtQjtFQUNuQixrQkFBa0I7RUFDbEIsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsY0FBYztFQUNkLDRFQUE0RTtFQUM1RSxlQUFlO0VBQ2YsaUJBQWlCO0VBQ2pCLGdCQUFnQjtFQUNoQixpQkFBaUI7QUFDbkI7O0FBRUE7O0VBRUUsbUJBQW1CO0VBQ25CLGVBQWU7QUFDakI7O0FBRUE7RUFDRSx5QkFBeUI7RUFDekIseUJBQXlCO0VBQ3pCLDRCQUE0QjtFQUM1QixrQkFBa0I7RUFDbEIsa0NBQWtDO0VBQ2xDLGNBQWM7RUFDZCxxQkFBcUI7RUFDckIsMEVBQTBFO0VBQzFFLGlCQUFpQjtFQUNqQixnQkFBZ0I7RUFDaEIsc0JBQXNCO0FBQ3hCOztBQUVBO0VBQ0UscUJBQXFCO0VBQ3JCLGtCQUFrQjtFQUNsQixVQUFVO0FBQ1o7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsV0FBVztBQUNiOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLFdBQVc7QUFDYjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsV0FBVztBQUNiOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLFdBQVc7QUFDYjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxnQkFBZ0I7RUFDaEIsV0FBVztBQUNiOztBQUVBO0VBQ0UsZ0JBQWdCO0VBQ2hCLFdBQVc7QUFDYjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxpQkFBaUI7RUFDakIsWUFBWTtBQUNkOztBQUVBO0VBQ0UsaUJBQWlCO0VBQ2pCLFlBQVk7QUFDZDs7QUFFQTtFQUNFLGlCQUFpQjtFQUNqQixZQUFZO0FBQ2Q7O0FBRUE7RUFDRSxxQkFBcUI7QUFDdkI7O0FBRUE7RUFDRSxlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsMkJBQTJCO0VBQzNCLHNCQUFzQjtBQUN4Qjs7QUFFQTtFQUNFLHlCQUF5QjtBQUMzQjs7QUFFQTtFQUNFLHlCQUF5QjtBQUMzQjs7QUFFQTtFQUNFLDJCQUEyQjtBQUM3Qjs7QUFFQTtFQUNFLDJCQUEyQjtBQUM3Qjs7QUFFQTtFQUNFLDRCQUE0QjtBQUM5Qjs7QUFFQTtFQUNFLDRCQUE0QjtBQUM5Qjs7QUFFQTtFQUNFLDRCQUE0QjtBQUM5Qjs7QUFFQTtFQUNFLDRCQUE0QjtBQUM5Qjs7QUFFQTtFQUNFLDRCQUE0QjtBQUM5Qjs7QUFFQTtFQUNFLDRCQUE0QjtBQUM5Qjs7QUFFQTtFQUNFLDRCQUE0QjtBQUM5Qjs7QUFFQTtFQUNFLDRCQUE0QjtBQUM5Qjs7QUFFQTtFQUNFLDZCQUE2QjtBQUMvQjs7QUFFQTtFQUNFLDZCQUE2QjtBQUMvQiIsInNvdXJjZVJvb3QiOiIifQ== */
  </style>
  <style>
  /**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}

/*# sourceURL=webpack://./node_modules/prismjs/themes/prism.css */
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL25vZGVfbW9kdWxlcy9wcmlzbWpzL3RoZW1lcy9wcmlzbS5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7RUFJRTs7QUFFRjs7Q0FFQyxZQUFZO0NBQ1osZ0JBQWdCO0NBQ2hCLHdCQUF3QjtDQUN4QixzRUFBc0U7Q0FDdEUsY0FBYztDQUNkLGdCQUFnQjtDQUNoQixnQkFBZ0I7Q0FDaEIsb0JBQW9CO0NBQ3BCLGtCQUFrQjtDQUNsQixpQkFBaUI7Q0FDakIsZ0JBQWdCOztDQUVoQixnQkFBZ0I7Q0FDaEIsY0FBYztDQUNkLFdBQVc7O0NBRVgscUJBQXFCO0NBQ3JCLGtCQUFrQjtDQUNsQixpQkFBaUI7Q0FDakIsYUFBYTtBQUNkOztBQUVBOztDQUVDLGlCQUFpQjtDQUNqQixtQkFBbUI7QUFDcEI7O0FBRUE7O0NBRUMsaUJBQWlCO0NBQ2pCLG1CQUFtQjtBQUNwQjs7QUFFQTtDQUNDOztFQUVDLGlCQUFpQjtDQUNsQjtBQUNEOztBQUVBLGdCQUFnQjtBQUNoQjtDQUNDLFlBQVk7Q0FDWixjQUFjO0NBQ2QsY0FBYztBQUNmOztBQUVBOztDQUVDLG1CQUFtQjtBQUNwQjs7QUFFQSxnQkFBZ0I7QUFDaEI7Q0FDQyxhQUFhO0NBQ2IsbUJBQW1CO0NBQ25CLG1CQUFtQjtBQUNwQjs7QUFFQTs7OztDQUlDLGdCQUFnQjtBQUNqQjs7QUFFQTtDQUNDLFdBQVc7QUFDWjs7QUFFQTtDQUNDLFdBQVc7QUFDWjs7QUFFQTs7Ozs7OztDQU9DLFdBQVc7QUFDWjs7QUFFQTs7Ozs7O0NBTUMsV0FBVztBQUNaOztBQUVBOzs7OztDQUtDLGNBQWM7Q0FDZCxvRUFBb0U7Q0FDcEUsaUNBQWlDO0FBQ2xDOztBQUVBOzs7Q0FHQyxXQUFXO0FBQ1o7O0FBRUE7O0NBRUMsY0FBYztBQUNmOztBQUVBOzs7Q0FHQyxXQUFXO0FBQ1o7O0FBRUE7O0NBRUMsaUJBQWlCO0FBQ2xCO0FBQ0E7Q0FDQyxrQkFBa0I7QUFDbkI7O0FBRUE7Q0FDQyxZQUFZO0FBQ2IiLCJzb3VyY2VSb290IjoiIn0= */
  </style>
  <style>
  
  </style>
  <style>
    .markdown-body {
      font-family: -apple-system,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;
      box-sizing: border-box;
      min-width: 200px;
      max-width: 980px;
      margin: 0 auto;
      padding: 45px;
    }

    @media not print {
      .markdown-body {
        padding: 45px;
      }

      @media (max-width: 767px) {
        .markdown-body {
          padding: 15px;
        }
      }
    }

    .hf-container {
      color: #24292e;
      line-height: 1.3;
    }

    .markdown-body .highlight pre,
    .markdown-body pre {
      white-space: pre-wrap;
    }
    .markdown-body table {
      display: table;
    }
    .markdown-body img[data-align="center"] {
      display: block;
      margin: 0 auto;
    }
    .markdown-body img[data-align="right"] {
      display: block;
      margin: 0 0 0 auto;
    }
    .markdown-body li.task-list-item {
      list-style-type: none;
    }
    .markdown-body li > [type=checkbox] {
      margin: 0 0 0 -1.3em;
    }
    .markdown-body input[type="checkbox"] ~ p {
      margin-top: 0;
      display: inline-block;
    }
    .markdown-body ol ol,
    .markdown-body ul ol {
      list-style-type: decimal;
    }
    .markdown-body ol ol ol,
    .markdown-body ol ul ol,
    .markdown-body ul ol ol,
    .markdown-body ul ul ol {
      list-style-type: decimal;
    }
  </style>
  <style>.markdown-body a.footnote-ref {
  text-decoration: none;
}

.footnotes {
  font-size: .85em;
  opacity: .8;
}

.footnotes li[role="doc-endnote"] {
  position: relative;
}

.footnotes .footnote-back {
  position: absolute;
  font-family: initial;
  top: .2em;
  right: 1em;
  text-decoration: none;
}

.inline-math.invalid,
.multiple-math.invalid {
  color: rgb(255, 105, 105);
}

.toc-container {
  width: 100%;
}

.toc-container .toc-title {
  font-weight: 700;
  font-size: 1.2em;
  margin-bottom: 0;
}

.toc-container li,
.toc-container ul,
.toc-container ul li {
  list-style: none !important;
}

.toc-container > ul {
  padding-left: 0;
}

.toc-container ul li span {
  display : flex;
}

.toc-container ul li span a {
  color: inherit;
  text-decoration: none;
}
.toc-container ul li span a:hover {
  color: inherit;
  text-decoration: none;
}

.toc-container ul li span span.dots {
  flex: 1;
  height: 0.65em;
  margin: 0 10px;
  border-bottom: 2px dotted black;
}

/*# sourceURL=webpack://./src/muya/lib/assets/styles/exportStyle.css */
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tdXlhL2xpYi9hc3NldHMvc3R5bGVzL2V4cG9ydFN0eWxlLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLHFCQUFxQjtBQUN2Qjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxrQkFBa0I7QUFDcEI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsb0JBQW9CO0VBQ3BCLFNBQVM7RUFDVCxVQUFVO0VBQ1YscUJBQXFCO0FBQ3ZCOztBQUVBOztFQUVFLHlCQUF5QjtBQUMzQjs7QUFFQTtFQUNFLFdBQVc7QUFDYjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixnQkFBZ0I7RUFDaEIsZ0JBQWdCO0FBQ2xCOztBQUVBOzs7RUFHRSwyQkFBMkI7QUFDN0I7O0FBRUE7RUFDRSxlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsY0FBYztBQUNoQjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxxQkFBcUI7QUFDdkI7QUFDQTtFQUNFLGNBQWM7RUFDZCxxQkFBcUI7QUFDdkI7O0FBRUE7RUFDRSxPQUFPO0VBQ1AsY0FBYztFQUNkLGNBQWM7RUFDZCwrQkFBK0I7QUFDakMiLCJzb3VyY2VSb290IjoiIn0= */</style>
  <style>.markdown-body{}pre.front-matter{display:none!important;}</style>

<style>
  span.dots {
    display: none !important;
  }
  
  .toc-title {
    font-size: 2rem !important;
  }
  
  .toc-h1 {
    color: #4183CC !important;
    font-weight: bold !important;
    font-size: 1.2rem;
  }
  
  .toc-h2, .toc-h3, .toc-h4 {
    color: #4183CF !important;
    font-size: 1.0rem;
  }
  
  .toc-h2 {
    font-size: 1.2rem;
  }
  
  
  .toc-h1:hover, .toc-h2:hover, .toc-h3:hover, .toc-h4:hover {
    color: #4183EF !important;
    text-decoration: underline !important;
  }
</style>
</head>
<body>
  <article class="markdown-body"><div class="toc-container"><p class="toc-title">目录</p><ul class="toc-list"><li><span><a class="toc-h1" href="#准备工作">准备工作</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#前置条件">前置条件</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#安装框架工具">安装框架工具</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#项目初始化">项目初始化</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#项目启动">项目启动</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#框架设计">框架设计</a><span class="dots"></span></span><ul><li><span><a class="toc-h3" href="#项目目录结构">项目目录结构</a><span class="dots"></span></span></li></ul></li></ul></li><li><span><a class="toc-h1" href="#路由">路由</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#路由注册">路由注册</a><span class="dots"></span></span><ul><li><span><a class="toc-h3" href="#函数注册">函数注册</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#对象注册">对象注册</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#分组注册">分组注册</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h2" href="#规范路由">规范路由</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#请求输入">请求输入</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#普通请求输入">普通请求输入</a><span class="dots"></span></span><ul><li><span><a class="toc-h3" href="#query参数获取">query参数获取</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#表单参数获取（post参数获取）">表单参数获取（POST参数获取）</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#动态路由参数获取">动态路由参数获取</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#所有请求参数获取">所有请求参数获取</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h2" href="#api请求输入">Api请求输入</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#响应输出">响应输出</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#文本数据返回">文本数据返回</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#json数据返回">JSON数据返回</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#模板内容返回">模板内容返回</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#api数据返回">API数据返回</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#数据库">数据库</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#数据库准备">数据库准备</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#数据库配置">数据库配置</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#驱动添加与导入">驱动添加与导入</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#数据库基本操作">数据库基本操作</a><span class="dots"></span></span><ul><li><span><a class="toc-h3" href="#查询数据">查询数据</a><span class="dots"></span></span><ul><li><span><a class="toc-h4" href="#oneallcountvaluearrayfields">One/All/Count/Value/Array/Fields</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#maxminsumavg">Max/Min/Sum/Avg</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#wherewherewhereorwhereor">Where/Where\*/WhereOr/WhereOr\*</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#grouporderorder">Group/Order/Order*</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#scan">Scan</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#查询结果为空判断">查询结果为空判断</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#分页">分页</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h3" href="#插入数据">插入数据</a><span class="dots"></span></span><ul><li><span><a class="toc-h4" href="#insertreplacesave">Insert/Replace/Save</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#insertandgetid">InsertAndGetId</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#gdbraw">gdb.Raw</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h3" href="#更新数据">更新数据</a><span class="dots"></span></span><ul><li><span><a class="toc-h4" href="#update">Update</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#incrementdecrement">Increment/Decrement</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h3" href="#删除数据">删除数据</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h2" href="#时间维护与软删除">时间维护与软删除</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#事务处理">事务处理</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#原生sql的使用">原生SQL的使用</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#dao自动生成与使用">DAO自动生成与使用</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#字段过滤">字段过滤</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#关联查询">关联查询</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#模板引擎">模板引擎</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#简单使用示例">简单使用示例</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#模板配置">模板配置</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#静态资源">静态资源</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#条件判断">条件判断</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#循环">循环</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#上传与下载">上传与下载</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#文件上传">文件上传</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#文件下载">文件下载</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#上传限制">上传限制</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#数据校验">数据校验</a><span class="dots"></span></span></li><li><span><a class="toc-h1" href="#cookiesession">Cookie/Session</a><span class="dots"></span></span></li><li><span><a class="toc-h1" href="#golang-jwt">golang-jwt</a><span class="dots"></span></span></li><li><span><a class="toc-h1" href="#中间件">中间件</a><span class="dots"></span></span></li><li><span><a class="toc-h1" href="#组件">组件</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#数据结构">数据结构</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#时间">时间</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#随机数">随机数</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#接口文档">接口文档</a><span class="dots"></span></span></li><li><span><a class="toc-h1" href="#构建打包">构建打包</a><span class="dots"></span></span></li><li><span><a class="toc-h1" href="#综合示例">综合示例</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#"></a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#后续学习项目">后续学习项目</a><span class="dots"></span></span></li></ul></div><br>

<br>

<p><strong>本文开始记录开始时间为2023-09，如果官方文档有更新导致本文中链接失效或与官方文档不相同的地方或错漏，以官方文档为准</strong></p>
<br>

<br>

<h1 class="atx" id="准备工作">准备工作</h1>
<h2 class="atx" id="前置条件">前置条件</h2>
<p>已安装Go语言开发环境，已配置好GOROOT、GOPATH环境变量</p>
<p>熟悉Go语言基本语法与使用</p>
<p>GoFrame文档：<a href="https://goframe.org/">https://goframe.org/</a></p>
<p>学习过程以官方文档为主，本文内容均摘自官方文档，</p>
<p>本阶段只介绍Web开发部分，微服务部分以后有机会新开</p>
<h2 class="atx" id="安装框架工具">安装框架工具</h2>
<p><a href="https://github.com/gogf/gf/releases">https://github.com/gogf/gf/releases</a></p>
<p>下载对应的包安装。推荐安装到GOROOT的bin目录中</p>
<p>用以下命令查看是否安装成功</p>
<pre><code class="fenced-code-block language-shell">gf -v</code></pre>
<h2 class="atx" id="项目初始化">项目初始化</h2>
<pre><code class="fenced-code-block language-shell">go <span class="token function">env</span> -w <span class="token assign-left variable">GO111MODULE</span><span class="token operator">=</span>on
go <span class="token function">env</span> -w <span class="token assign-left variable">GOPROXY</span><span class="token operator">=</span>https://goproxy.cn
<span class="token comment"># 如果已经设置过可以不要上面这两行</span>

gf init gf_demo -u <span class="token comment"># 如果之前已经创建过项目，并且不需要创建最新版本则省略-u</span></code></pre>
<blockquote>
<p> 常用代理地址：</p>
<ul>
<li><code>https://goproxy.cn</code></li>
<li><code>https://goproxy.io</code></li>
<li><code>https://mirrors.aliyun.com/goproxy/</code></li>
</ul>
</blockquote>
<h2 class="atx" id="项目启动">项目启动</h2>
<p>进入项目中main.go文件所在的目录运行如下命令</p>
<pre><code class="fenced-code-block language-shell">gf run main.go</code></pre>
<p>启动成功后，在浏览器中输入<code>http://127.0.0.1:8000/hello</code>查看结果</p>
<br>

<br>

<h2 class="atx" id="框架设计">框架设计</h2>
<p>关于框架设计的内容，有点过于抽象，内容也是偏理论的，初学就来纠结这部分基本上也难以理解，所以这部分的其他内容可以放到以后再来研究。不过也需要了解一点基础知识，比如<code>MVC</code>与<code>3-Tier Architecture</code>，这部分内容详见文档<a href="https://goframe.org/pages/viewpage.action?pageId=3672442">代码分层设计</a>，不需要完全理解，知道个大概也就可以了。</p>
<h3 class="atx" id="项目目录结构">项目目录结构</h3>
<pre style="background: #272822; color: white">/
├── api                 请求接口输入/输出数据结构定义
├── hack                项目开发工具、脚本
├── internal            业务逻辑存放目录，核心代码
│   ├── cmd             入口指令与其他命令工具目录
│   ├── consts          常量定义目录
│   ├── controller      控制器目录，接收/解析用户请求
│   ├── dao             数据访问对象目录，用于和底层数据库交互
│   ├── logic           核心业务逻辑代码目录
│   ├── model           数据结构管理模块，管理数据实体对象，以及输入与输出数据结构定义
│   |   ├── do          数据操作中业务模型与实例模型转换，由工具维护，不能手动修改
│   │   └── entity      数据模型是模型与数据集合的一对一关系，由工具维护，不用手动修改。
│   └── service         业务接口定义层。具体的接口实现在logic中进行注入。
├── manifest            包含程序编译、部署、运行、配置的文件
├── resource            静态资源文件
├── utility
├── go.mod
└── main.go             程序入口文件
</pre>

<p>有关项目目录更多详细介绍以及请求分层流转见文档<a href="https://goframe.org/pages/viewpage.action?pageId=30740166">工程目录设计</a></p>
<br>

<br>

<h1 class="atx" id="路由">路由</h1>
<h2 class="atx" id="路由注册">路由注册</h2>
<h3 class="atx" id="函数注册">函数注册</h3>
<p><strong>相关方法：</strong></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">BindHandler</span><span class="token punctuation">(</span>pattern <span class="token builtin">string</span><span class="token punctuation">,</span> handler <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>其中<code>handler</code>的定义方式有如下两种：</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span><span class="token punctuation">(</span>request <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span>
<span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> BizRequest<span class="token punctuation">)</span><span class="token punctuation">(</span>BizResponse<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span></code></pre>
<p><strong>匿名函数与普通函数注册</strong>
<code>internal/cmd/cmd.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> cmd

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"context"</span>

    <span class="token string">"github.com/gogf/gf/v2/frame/g"</span>
    <span class="token string">"github.com/gogf/gf/v2/net/ghttp"</span>
    <span class="token string">"github.com/gogf/gf/v2/os/gcmd"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">handler</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;Hello World From handler&lt;/h1&gt;"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> <span class="token punctuation">(</span>
    Main <span class="token operator">=</span> gcmd<span class="token punctuation">.</span>Command<span class="token punctuation">{</span>
        Name<span class="token punctuation">:</span>  <span class="token string">"main"</span><span class="token punctuation">,</span>
        Usage<span class="token punctuation">:</span> <span class="token string">"main"</span><span class="token punctuation">,</span>
        Brief<span class="token punctuation">:</span> <span class="token string">"start http server"</span><span class="token punctuation">,</span>
        Func<span class="token punctuation">:</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> parser <span class="token operator">*</span>gcmd<span class="token punctuation">.</span>Parser<span class="token punctuation">)</span> <span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            s <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Server</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment">// 直接用匿名函数进行路由注册</span>
            s<span class="token punctuation">.</span><span class="token function">BindHandler</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;Hello World!&lt;/h1&gt;"</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>

            <span class="token comment">// 或者使用提前定义好的函数来进行注册</span>
            s<span class="token punctuation">.</span><span class="token function">BindHandler</span><span class="token punctuation">(</span><span class="token string">"/world"</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

            s<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">nil</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span></code></pre>
<p>注册成功后在浏览器输入<a href="http://127.0.0.1:8000/hello">http://127.0.0.1:8000/hello</a>或者<a href="http://127.0.0.1:8000/world">http://127.0.0.1:8000/world</a>即可访问对应的路由</p>
<p><strong>指定HTTP请求方法</strong>
上述方法注册路由默认支持所有HTTP请求方法，如果需要指定请求方法，可用以下写法：</p>
<pre><code class="fenced-code-block language-go"><span class="token comment">// 该路由只支持GET请求</span>
s<span class="token punctuation">.</span><span class="token function">BindHandler</span><span class="token punctuation">(</span><span class="token string">"GET:/hello"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;Hello World! GET&lt;/h1&gt;"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 该路由只支持POST请求</span>
s<span class="token punctuation">.</span><span class="token function">BindHandler</span><span class="token punctuation">(</span><span class="token string">"POST:/hello"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;Hello World! POST&lt;/h1&gt;"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>对于同一路由可以定义不同的请求方法实现不同功能。</p>
<blockquote>
<p>几个最常用HTTP方法</p>
<table>
<thead>
<tr>
<th align="center">方法</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">GET</td>
<td align="center">用于获取数据，不会修改服务端资源数据</td>
</tr>
<tr>
<td align="center">POST</td>
<td align="center">将资源数据提交到服务端，常用于在服务端创建新数据</td>
</tr>
<tr>
<td align="center">PUT</td>
<td align="center">将资源数据提交到服务端，常用于修改已存在的资源数据</td>
</tr>
<tr>
<td align="center">DELETE</td>
<td align="center">用于删除服务端资源数据</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
</blockquote>
<p><strong>对象方法注册</strong></p>
<p>还可以用对象当中的方法来注册路由。</p>
<p>选定义一个名为<code>user</code>控制器</p>
<p><code>internal/controller/user/user.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> user

<span class="token keyword">import</span> <span class="token string">"github.com/gogf/gf/v2/net/ghttp"</span>

<span class="token keyword">type</span> Controller <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>Controller <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>Controller<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">AddUser</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"添加用户"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">UpdateUser</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"更新用户"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">DeleteUser</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"删除用户"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">ListUser</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"用户列表"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">GetUser</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"查询一个用户"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Post</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"添加用户"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Put</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"更新用户"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Delete</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"删除用户"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Get</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"查询一个用户"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<p><code>internal/cmd/cmd.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> cmd

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"context"</span>

    <span class="token comment">// 引入控制器user包</span>
    <span class="token string">"gf_demo/internal/controller/user"</span>

    <span class="token string">"github.com/gogf/gf/v2/frame/g"</span>
    <span class="token string">"github.com/gogf/gf/v2/os/gcmd"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> <span class="token punctuation">(</span>
    Main <span class="token operator">=</span> gcmd<span class="token punctuation">.</span>Command<span class="token punctuation">{</span>
        Name<span class="token punctuation">:</span>  <span class="token string">"main"</span><span class="token punctuation">,</span>
        Usage<span class="token punctuation">:</span> <span class="token string">"main"</span><span class="token punctuation">,</span>
        Brief<span class="token punctuation">:</span> <span class="token string">"start http server"</span><span class="token punctuation">,</span>
        Func<span class="token punctuation">:</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> parser <span class="token operator">*</span>gcmd<span class="token punctuation">.</span>Parser<span class="token punctuation">)</span> <span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            s <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Server</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment">// 定义对象</span>
            usercontroller <span class="token operator">:=</span> user<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">// 将对象方法绑定到路由</span>
            s<span class="token punctuation">.</span><span class="token function">BindHandler</span><span class="token punctuation">(</span><span class="token string">"/adduser"</span><span class="token punctuation">,</span> usercontroller<span class="token punctuation">.</span>AddUser<span class="token punctuation">)</span>

            s<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">nil</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span></code></pre>
<h3 class="atx" id="对象注册">对象注册</h3>
<p>对象里的方法可以批量注册</p>
<p>相关方法</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">BindObject</span><span class="token punctuation">(</span>pattern <span class="token builtin">string</span><span class="token punctuation">,</span> object <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> method <span class="token operator">...</span><span class="token builtin">string</span><span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">BindObjectMethod</span><span class="token punctuation">(</span>pattern <span class="token builtin">string</span><span class="token punctuation">,</span> object <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> method <span class="token builtin">string</span><span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>Server<span class="token punctuation">)</span> <span class="token function">BindObjectRest</span><span class="token punctuation">(</span>pattern <span class="token builtin">string</span><span class="token punctuation">,</span> object <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p><strong>绑定全部公共方法</strong></p>
<p><code>internal/cmd/cmd.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> cmd

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"context"</span>
    <span class="token string">"starting/internal/controller/user"</span>

    <span class="token string">"github.com/gogf/gf/v2/frame/g"</span>
    <span class="token string">"github.com/gogf/gf/v2/os/gcmd"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> <span class="token punctuation">(</span>
    Main <span class="token operator">=</span> gcmd<span class="token punctuation">.</span>Command<span class="token punctuation">{</span>
        Name<span class="token punctuation">:</span>  <span class="token string">"main"</span><span class="token punctuation">,</span>
        Usage<span class="token punctuation">:</span> <span class="token string">"main"</span><span class="token punctuation">,</span>
        Brief<span class="token punctuation">:</span> <span class="token string">"start http server"</span><span class="token punctuation">,</span>
        Func<span class="token punctuation">:</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> parser <span class="token operator">*</span>gcmd<span class="token punctuation">.</span>Parser<span class="token punctuation">)</span> <span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            s <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Server</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

            usercontroller <span class="token operator">:=</span> user<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment">// 绑定user控制器中所有公共方法</span>
            s<span class="token punctuation">.</span><span class="token function">BindObject</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> usercontroller<span class="token punctuation">)</span>

            s<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">nil</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span></code></pre>
<p><strong>绑定指定方法</strong></p>
<pre><code class="fenced-code-block language-go">usercontroller <span class="token operator">:=</span> user<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 绑定user控制器中多个方法</span>
s<span class="token punctuation">.</span><span class="token function">BindObject</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> usercontroller<span class="token punctuation">,</span> <span class="token string">"AddUser,UpdateUser"</span><span class="token punctuation">)</span>
<span class="token comment">// 绑定单个方法</span>
s<span class="token punctuation">.</span><span class="token function">BindObjectMethod</span><span class="token punctuation">(</span><span class="token string">"/deluser"</span><span class="token punctuation">,</span> usercontroller<span class="token punctuation">,</span> <span class="token string">"DeleteUser"</span><span class="token punctuation">)</span></code></pre>
<p><strong>以RESTFul方绑定对象方法</strong></p>
<pre><code class="fenced-code-block language-go">usercontroller <span class="token operator">:=</span> user<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">BindObjectRest</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> usercontroller<span class="token punctuation">)</span></code></pre>
<h3 class="atx" id="分组注册">分组注册</h3>
<p>可以为不同路由设置一个相同的前缀，即分组路由，分组路由有以下两种写法</p>
<pre><code class="fenced-code-block language-go">s <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Server</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

usercontroller <span class="token operator">:=</span> user<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>group <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>RouterGroup<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    group<span class="token punctuation">.</span><span class="token function">Middleware</span><span class="token punctuation">(</span>ghttp<span class="token punctuation">.</span>MiddlewareHandlerResponse<span class="token punctuation">)</span>
    group<span class="token punctuation">.</span><span class="token function">Bind</span><span class="token punctuation">(</span>
        usercontroller<span class="token punctuation">,</span> <span class="token comment">// 绑定到控制器对象</span>
    <span class="token punctuation">)</span>

    <span class="token comment">// 可以用GET POST PUT等定义路由</span>
    group<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"/user/get"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

s<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<pre><code class="fenced-code-block language-go">s <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Server</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

usercontroller <span class="token operator">:=</span> user<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
group <span class="token operator">:=</span> s<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">)</span>
group<span class="token punctuation">.</span><span class="token function">Middleware</span><span class="token punctuation">(</span>ghttp<span class="token punctuation">.</span>MiddlewareHandlerResponse<span class="token punctuation">)</span>
group<span class="token punctuation">.</span><span class="token function">Bind</span><span class="token punctuation">(</span>
    usercontroller<span class="token punctuation">,</span> <span class="token comment">// 绑定到控制器对象</span>
<span class="token punctuation">)</span>

<span class="token comment">// 可以用GET POST PUT等定义路由</span>
group<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"/user/get"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

s<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<h2 class="atx" id="规范路由">规范路由</h2>
<p>GoFrame中提供了规范化的路由注册方式，注册方法如下 </p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token function">Handler</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req <span class="token operator">*</span>Request<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>Response<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span></code></pre>
<p>其中<code>Request</code>与<code>Response</code>为自定义的结构体。</p>
<p>通过如下方式指定请求方法与路径</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> HelloReq <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta <span class="token string">`path:"/hello" method:"get"`</span>
<span class="token punctuation">}</span></code></pre>
<br>

<h1 class="atx" id="请求输入">请求输入</h1>
<h2 class="atx" id="普通请求输入">普通请求输入</h2>
<p>基础代码如下：路由用group绑定到控制器后，在控制器中写如下方法，以下代码均在此修改：</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Params</span><span class="token punctuation">(</span>request <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    m <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetQueryMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    request<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteJson</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<h3 class="atx" id="query参数获取">query参数获取</h3>
<p>query参数是指以<code>?a=1&amp;b=2</code>的形式写在url中的参数，通常由GET方法传递。</p>
<br>

<p><strong>单个参数值</strong></p>
<pre><code class="fenced-code-block language-go">m <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetQuery</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span></code></pre>
<p>GetQuery可以指定参数名称，获取对应的参数值，如果值不存在，则返回<code>nil</code></p>
<p>还可以指定默认值，当对应参数值不存在时，返回指定的默认值</p>
<pre><code class="fenced-code-block language-go">m <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetQuery</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"孙行者"</span><span class="token punctuation">)</span></code></pre>
<p>返回的是一个<code>gvar.Var </code>类型，可以根据需要进行类型转换，常用类型转换方法如下</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> 
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Bool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> 
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Int</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Int8</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int8</span> 
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Int16</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int16</span> 
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Int32</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int32</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Int64</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int64</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Uint</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">uint</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Uint8</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">uint8</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Uint16</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">uint16</span> 
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Uint32</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">uint32</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Uint64</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">uint64</span> 
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Float32</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">float32</span> 
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Float64</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">float64</span> 
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Time</span><span class="token punctuation">(</span>format <span class="token operator">...</span><span class="token builtin">string</span><span class="token punctuation">)</span> time<span class="token punctuation">.</span>Time
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">Duration</span><span class="token punctuation">(</span><span class="token punctuation">)</span> time<span class="token punctuation">.</span>Duration 
<span class="token keyword">func</span> <span class="token punctuation">(</span>v <span class="token operator">*</span>Var<span class="token punctuation">)</span> <span class="token function">GTime</span><span class="token punctuation">(</span>format <span class="token operator">...</span><span class="token builtin">string</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>批量获取Query参数</strong></p>
<p>GoFrame中提供了<code>GetQueryMap</code>，<code>GetQueryMapStrStr</code>，<code>GetQueryMapStrVar</code>三个方法用于批量获取Query参数，三个方法使用方式一致，只是返回类型不同。</p>
<ul>
<li>获取全部Query参数</li>
</ul>
<pre><code class="fenced-code-block language-go">m <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetQueryMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<ul>
<li>指定需要获取的参数名称与默认值</li>
</ul>
<pre><code class="fenced-code-block language-go">m <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetQueryMap</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"者行孙"</span><span class="token punctuation">,</span> <span class="token string">"age"</span><span class="token punctuation">:</span> <span class="token number">600</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>将Query参数转化为自定义结构体</strong></p>
<p>可以自定义结构体，将请求参数直接转化为对应的结构体：</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> user <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Name <span class="token builtin">string</span>
    Age  <span class="token builtin">int</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> u <span class="token operator">*</span>user
err <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">ParseQuery</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>u<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    request<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WritelnExit</span><span class="token punctuation">(</span><span class="token string">"转换出借"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<p>如上，结构体中成员为<code>Name</code>、<code>Age</code>，参数为<code>name</code>和<code>age</code>则参成功转换，如果结构体成员变量名与参数名不一致则无法转换，此时需要为成员变量指定其对应的参数，可以用<code>json:</code>/<code>param:</code>/<code>p:</code>这些方式来指定。如下</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> user <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    UserName <span class="token builtin">string</span> <span class="token string">`json:"name"`</span>
    UserAge  <span class="token builtin">int</span>    <span class="token string">`p:"age"`</span>
<span class="token punctuation">}</span></code></pre>
<br>

<h3 class="atx" id="表单参数获取（post参数获取）">表单参数获取（POST参数获取）</h3>
<p>表单参数获取是指获取<code>application/x-www-form-urlencoded</code>、<code>application/form-data</code>、<code>multipart/form-data</code>等数据，也可以用来获取以json格式提交的数据，简单理解即为可以获取POST方法提交的数据。 </p>
<br>

<p><strong>单个参数</strong></p>
<pre><code class="fenced-code-block language-go">m <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetForm</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span></code></pre>
<p><code>GetForm</code>用于指定参数名称，获取对应参数值，如果对应参数不存在，返回<code>nil</code></p>
<p>也可以指定默认值，当指定参数不存在时，返回默认值</p>
<pre><code class="fenced-code-block language-go">m <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetForm</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"烧包谷"</span><span class="token punctuation">)</span></code></pre>
<p>返回的是一个<code>gvar.Var </code>类型，可以根据需要进行类型转换</p>
<br>

<p><strong>批量获取请求数据</strong></p>
<p>可以用<code>GetFormMap</code>、<code>GetFormMapStrStr</code>、<code>GetFormMapStrVar</code>批量获取请求数据，三个方法使用方式一样，只是返回的Map类型不同。</p>
<pre><code class="fenced-code-block language-go">m <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetFormMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>可以指定需要获取的参数以及默认值</p>
<pre><code class="fenced-code-block language-go">m <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetFormMap</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"大洋芋"</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>将请求数据转化为自定义结构体</strong></p>
<p>和Query参数一样，也可以将请求参数直接转为自定义结构体。如果结构体成员名称与参数名称不一致，也可以用<code>json:</code>、<code>param:</code>、<code>p:</code>这些tag来指定对应的参数名称</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> user <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    UserName <span class="token builtin">string</span> <span class="token string">`json:"name"`</span>
    UserAge  <span class="token builtin">int</span>    <span class="token string">`p:"age"`</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> u <span class="token operator">*</span>user
err <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">ParseForm</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>u<span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    request<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WritelnExit</span><span class="token punctuation">(</span><span class="token string">"转换出借"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<br>

<h3 class="atx" id="动态路由参数获取">动态路由参数获取</h3>
<p>动态路由需要对现有代码进行一点改动，需要先在<code>api</code>包中定义请求与返回数据格式，对指定的路由进行动态注册：</p>
<p><code>api</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> api

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"github.com/gogf/gf/v2/frame/g"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Res <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta <span class="token string">`mime:"text/html"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> ParamReq <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta <span class="token string">`path:"/params/:name" method:"all"`</span>
<span class="token punctuation">}</span></code></pre>
<p>再将控制器的的方法利用<code>api</code>数据结构进行修改：</p>
<p><code>Controller</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Params</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req <span class="token operator">*</span>api<span class="token punctuation">.</span>ParamReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>api<span class="token punctuation">.</span>Res<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    request <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">RequestFromCtx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
    u <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetRouter</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>
    request<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteJson</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span><span class="token string">"data"</span><span class="token punctuation">:</span> u<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>获取单个参数</strong></p>
<pre><code class="fenced-code-block language-go">u <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetRouter</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span></code></pre>
<p>返回<code>gvar.Var</code>类型，可以按需要进行类型转换。也可以指定默认值。</p>
<br>

<p><strong>批量获取参数</strong></p>
<pre><code class="fenced-code-block language-go">u <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetRouterMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>返回值为<code>map[string]string</code>。如果没有设置动态路由，则返回<code>nil</code></p>
<br>

<h3 class="atx" id="所有请求参数获取">所有请求参数获取</h3>
<p>GoFrame中还提供了一些方法获取所有请求参数，用法与上面两种类似，只是不区分请求方法。如果GET和POST提供的参数名称相同，则POST参数优先。</p>
<p><strong>获取单个参数</strong></p>
<pre><code class="fenced-code-block language-go">data <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetRequest</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>
<span class="token comment">// 简写</span>
data <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span></code></pre>
<p>返回<code>gvar.Var</code>类型，可以提供默认值。</p>
<br>

<p><strong>批量获取请求参数</strong></p>
<pre><code class="fenced-code-block language-go">data <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetRequestMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 可以指定需要获取的参数名及默认值</span>
data <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetRequestMap</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 还有以下几种</span>
data <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetRequestMapStrStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
data <span class="token operator">:=</span> request<span class="token punctuation">.</span><span class="token function">GetRequestMapStrVar</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>将请求参数转为自定义结构体</strong></p>
<pre><code class="fenced-code-block language-go">request<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>u<span class="token punctuation">)</span> <span class="token comment">// u为自定义结构体指针</span></code></pre>
<br>

<h2 class="atx" id="api请求输入">Api请求输入</h2>
<p>在<code>api</code>中定义请求与响应数据结构，可以直接将需要接收的参数定义为请求结构体的成员，请求时会自动转为对应结构体。</p>
<p>例如，将前面的<code>api</code>请求部分改为</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> ParamReq <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta   <span class="token string">`path:"/params" method:"post"`</span>
    UserName <span class="token builtin">string</span> <span class="token string">`p:"name" d:"林冲"`</span>
    UserAge  <span class="token builtin">int</span>    <span class="token string">`p:"age" d:"110"`</span>
<span class="token punctuation">}</span></code></pre>
<p>其中<code>p:</code>或<code>param:</code>用于指定该成员对应的请求参数名，<code>d:</code>或<code>default:</code>用于指定默认值。如果Query与Body中有相同名称的参数，则以Body中的参数优先。</p>
<br>

<h1 class="atx" id="响应输出">响应输出</h1>
<p>在控制器中新建如下方法，用来测试响应输出。以下所有代码均在此处修改。</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Resp</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 以下代码在此写</span>
<span class="token punctuation">}</span></code></pre>
<br>

<h2 class="atx" id="文本数据返回">文本数据返回</h2>
<p>GoFrame中通过以下方法返回文本数据到客户端：</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">Write</span><span class="token punctuation">(</span>content <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">WriteExit</span><span class="token punctuation">(</span>content <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">Writef</span><span class="token punctuation">(</span>format <span class="token builtin">string</span><span class="token punctuation">,</span> params <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">WritefExit</span><span class="token punctuation">(</span>format <span class="token builtin">string</span><span class="token punctuation">,</span> params <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">Writeln</span><span class="token punctuation">(</span>content <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">WritelnExit</span><span class="token punctuation">(</span>content <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">Writefln</span><span class="token punctuation">(</span>format <span class="token builtin">string</span><span class="token punctuation">,</span> params <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">WriteflnExit</span><span class="token punctuation">(</span>format <span class="token builtin">string</span><span class="token punctuation">,</span> params <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>以上方法中，带有<code>Exit</code>的表示执行完响应之后就退出本次请求，不再执行后面的内容。带有<code>ln</code>的表示会在响应内容的末尾追加换行符。</p>
<p>以上方法用于向客户端响应文本内容。内容格式为<code>text/html</code>或<code>text/plain</code>，参数可以是任意数据类型，非字符串类型通常会将内容进行json转为字符串后返回到客户端。</p>
<p>如果提供参数为文本，可以是普通文本也可以是HTML文本。</p>
<br>

<p><strong>响应简单文本</strong></p>
<pre><code class="fenced-code-block language-go">req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"锦瑟无端五十弦"</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>响应简单HTML</strong></p>
<pre><code class="fenced-code-block language-go">req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;春蚕到死丝方尽&lt;/h1&gt;"</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>响应复杂HTML</strong></p>
<pre><code class="fenced-code-block language-go">html <span class="token operator">:=</span> <span class="token string">`
    &lt;!DOCTYPE html&gt;
    &lt;html lang="en"&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Clock&lt;/title&gt;
        &lt;style&gt;
            @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&amp;display=swap');
            *
            {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
            }
            body 
            {
                display: flex;
                justify-content: center;
                align-items: center;
                min-height: 100vh;
                background: #acbaca;
            }
            .clock 
            {
                position: relative;
                width: 300px;
                height: 300px;
                background: #c9d5e0;
                display: flex;
                justify-content: center;
                align-items: center;
                border-radius: 50px;
                box-shadow: 30px 30px 30px -10px rgba(0,0,0,0.15),
                inset 15px 15px 10px rgba(255,255,255,0.75),
                -15px -15px 35px rgba(255,255,255,0.55),
                inset -1px -1px 10px rgba(0,0,0,0.2);
            }
            .clock::before 
            {
                content: '';
                position: absolute;
                width: 4px;
                height: 4px;
                background: #e91e63;
                border-radius: 50%;
                z-index: 1000;
                box-shadow: 0 0 0 1px #e91e63,
                0 0 0 3px #fff,
                0 0 5px 5px rgba(0,0,0,0.15);
            }
            .clock .numbers 
            {
                position: absolute;
                inset: 35px;
                background: #152b4a;
                border-radius: 50%;
                box-shadow: 5px 5px 15px #152b4a66,
                inset 5px 5px 5px rgba(255,255,255,0.55),
                -6px -6px 10px rgba(255,255,255,1);
            }
            .clock .numbers span 
            {
                position: absolute;
                inset: 5px;
                text-align: center;
                color: #fff;
                font-size: 1.25em;
                transform: rotate(calc(90deg * var(--i)));
            }
            .clock .numbers span b 
            {
                font-weight: 600;
                display: inline-block;
                transform: rotate(calc(-90deg * var(--i)));
            }
            .clock .numbers::before 
            {
                content: '';
                position: absolute;
                inset: 35px;
                background: linear-gradient(#2196f3,#e91e63);
                border-radius: 50%;
                animation: animate 2s linear infinite;
            }
            @keyframes animate 
            {
                0% 
                {
                    transform: rotate(360deg);
                }
                100% 
                {
                    transform: rotate(0deg);
                }
            }
            .clock .numbers::after 
            {
                content: '';
                position: absolute;
                inset: 38px;
                background: #152b4a;
                border-radius: 50%;
            }
            .clock .numbers .circle
            {
                position: absolute;
                inset: 0;
                border-radius: 50%;
                display: flex;
                justify-content: center;
                z-index: 10;
            }
            .clock .numbers .circle i 
            {
                position: absolute;
                width: 3px;
                height: 50%;
                background: #fff;
                transform-origin: bottom;
            }
            .clock .numbers .circle#hr i 
            {
                transform: scaleY(0.3);
                width: 4px;
            }
            .clock .numbers .circle#mn i 
            {
                transform: scaleY(0.45);
            }
            .clock .numbers .circle#sc i 
            {
                width: 2px;
                transform: scaleY(0.55);
                background: #e91e63;
                box-shadow: 0 30px 0 #e91e63;
            }
        &lt;/style&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class="clock"&gt;
            &lt;div class="numbers"&gt;
                &lt;span style="--i:0;"&gt;&lt;b&gt;12&lt;/b&gt;&lt;/span&gt;
                &lt;span style="--i:1;"&gt;&lt;b&gt;3&lt;/b&gt;&lt;/span&gt;
                &lt;span style="--i:2;"&gt;&lt;b&gt;6&lt;/b&gt;&lt;/span&gt;
                &lt;span style="--i:3;"&gt;&lt;b&gt;9&lt;/b&gt;&lt;/span&gt;
                &lt;div class="circle" id="hr"&gt;&lt;i&gt;&lt;/i&gt;&lt;/div&gt;
                &lt;div class="circle" id="mn"&gt;&lt;i&gt;&lt;/i&gt;&lt;/div&gt;
                &lt;div class="circle" id="sc"&gt;&lt;i&gt;&lt;/i&gt;&lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;script&gt;
            let hr = document.querySelector('#hr');
            let mn = document.querySelector('#mn');
            let sc = document.querySelector('#sc');

            setInterval(()=&gt;{
                let day = new Date();
                let hh = day.getHours() * 30;
                let mm = day.getMinutes() * 6;
                let ss = day.getSeconds() * 6;

                hr.style.transform = 'rotateZ(' + hh+(mm/12) + 'deg)';
                mn.style.transform = 'rotateZ(' + mm + 'deg)';
                sc.style.transform = 'rotateZ(' + ss + 'deg)';
            })
        &lt;/script&gt;
    &lt;/body&gt;
    &lt;/html&gt;
    `</span>
    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span></code></pre>
<br>

<p><strong>格式化数据填充</strong></p>
<pre><code class="fenced-code-block language-go">html <span class="token operator">:=</span> <span class="token string">`
    &lt;div&gt;姓名：%s&lt;/div&gt;
    &lt;div&gt;年龄：%d&lt;/div&gt;
    `</span>
req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writef</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">"林黛玉"</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span></code></pre>
<br>

<h2 class="atx" id="json数据返回">JSON数据返回</h2>
<p>GoFrame中可以通过以下方法返回JSON数据：</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">WriteJson</span><span class="token punctuation">(</span>content <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">WriteJsonExit</span><span class="token punctuation">(</span>content <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>通过以上方法，会直接将参数内容进行JSON转换之后返回到客户端，并且将响应头中<code>Content-Type</code>设置为 <code>application/json</code>。</p>
<br>

<h2 class="atx" id="模板内容返回">模板内容返回</h2>
<p>前面可以用<code>writef</code>将数据格式化到HTML内容当中，但这样的做法对于数据以及HTML文件较多的情况太过于麻烦，因此Web框架中一般会采用模板引擎，使用模板语言来进行数据渲染，简化HTML页面与后端数据的交互。</p>
<p>GoFrame中用以下方法进行模板解析和返回：</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">WriteTpl</span><span class="token punctuation">(</span>tpl <span class="token builtin">string</span><span class="token punctuation">,</span> params <span class="token operator">...</span>gview<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token builtin">error</span> 
<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">WriteTplDefault</span><span class="token punctuation">(</span>params <span class="token operator">...</span>gview<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token builtin">error</span> 
<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">WriteTplContent</span><span class="token punctuation">(</span>content <span class="token builtin">string</span><span class="token punctuation">,</span> params <span class="token operator">...</span>gview<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token builtin">error</span></code></pre>
<p>其中最常用的是<code>WriteTpl</code>，详细内容后面模板引擎内容里面再说，现在简单理解为该方法可以读取一个html文件，并将其返回给客户端。默认模板文件存放在<code>resource/template</code>下面，因此<code>WriteTpl</code>的第一个参数为对应的模板html文件相对于<code>template</code>的路径</p>
<p>示例：</p>
<pre><code class="fenced-code-block language-go">req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteTpl</span><span class="token punctuation">(</span><span class="token string">"index.html"</span><span class="token punctuation">)</span>
req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteTpl</span><span class="token punctuation">(</span><span class="token string">"user/index.html"</span><span class="token punctuation">)</span></code></pre>
<br>

<h2 class="atx" id="api数据返回">API数据返回</h2>
<p>现在Web应用多是前后端分离，返回数据为JSON格式，前面所说的<code>WriteJson</code>这样的方法只是单纯将提供的数据进行JSON转换后返回，在实际开发中，返回的JSON数据通常为以 下结构（具体项目会有差异，但基本都是类似结构）：</p>
<pre><code class="fenced-code-block language-json"><span class="token punctuation">{</span>
    <span class="token property">"code"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 自定义编码，用来表示请求成功与失败</span>
    <span class="token property">"msg"</span><span class="token operator">:</span><span class="token string">"请求成功"</span><span class="token punctuation">,</span> <span class="token comment">// 提示信息，如果请求出错则为错误信息</span>
    <span class="token property">"data"</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment">// 请求返回数据，请求出错一般为null</span>
<span class="token punctuation">}</span></code></pre>
<p>GoFrame为前后端分离的API开发提供了很好的支持，只需要借助<code>api</code>模块就可以方便完成类似的返回结构，不需要自行定义。</p>
<p>操作步骤如下：</p>
<ul>
<li>在<code>api</code>中定义请求与响应数据结构</li>
</ul>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> ApiReq <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta <span class="token string">`path:"/api" method:"all"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> ApiRes <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    UserName <span class="token builtin">string</span>    <span class="token string">`json:"name"`</span>
    UserAge  <span class="token builtin">int</span>    <span class="token string">`json:"age"`</span>
    List     g<span class="token punctuation">.</span>Array <span class="token string">`json:"list"`</span>
<span class="token punctuation">}</span></code></pre>
<ul>
<li>在控制器中定义对应的方法</li>
</ul>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Api</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req <span class="token operator">*</span>api<span class="token punctuation">.</span>ApiReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>api<span class="token punctuation">.</span>ApiRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span></code></pre>
<p><strong>实例化返回数据并返回</strong></p>
<pre><code class="fenced-code-block language-go">res <span class="token operator">=</span> <span class="token operator">&amp;</span>api<span class="token punctuation">.</span>ApiRes<span class="token punctuation">{</span>
    UserName<span class="token punctuation">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span>
    UserAge<span class="token punctuation">:</span>  <span class="token number">120</span><span class="token punctuation">,</span>
    List<span class="token punctuation">:</span>     g<span class="token punctuation">.</span>Array<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">return</span></code></pre>
<p><strong>如果有错误，定义错误信息并直接返回</strong></p>
<pre><code class="fenced-code-block language-go">err <span class="token operator">=</span> gerror<span class="token punctuation">.</span><span class="token function">Newf</span><span class="token punctuation">(</span><span class="token string">"服务器开小差了"</span><span class="token punctuation">)</span>
<span class="token keyword">return</span></code></pre>
<p>用上述方法返回数据，会自动返回如下格式JSON数据</p>
<pre><code class="fenced-code-block language-json"><span class="token punctuation">{</span>
    <span class="token property">"code"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"message"</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token property">"data"</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"张三"</span><span class="token punctuation">,</span>
        <span class="token property">"age"</span><span class="token operator">:</span><span class="token number">120</span><span class="token punctuation">,</span>
        <span class="token property">"list"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>以上数据格式是通过中间件<code>ghttp.MiddlewareHandlerResponse</code>实现的，实际应用当中可以仿照这一中间件自行定义中间件来确定需要的数据返回格式。</p>
<br>

<br>

<h1 class="atx" id="数据库">数据库</h1>
<h2 class="atx" id="数据库准备">数据库准备</h2>
<p>需要先安装MySQL数据库(也可以使用其他数据库，本教程以MySQL为例)，安装过程如果不了解的可以在B站搜一下MySQL相关教程。</p>
<ul>
<li><p>创建一个<code>goframe</code>数据库，字符集为<code>utf8</code></p>
</li>
<li><p>运行下列SQL，创建测试数据表</p>
</li>
</ul>
<pre><code class="fenced-code-block language-mysql">USE `goframe`;

/*Table structure for table `book` */

DROP TABLE IF EXISTS `book`;

CREATE TABLE `book` (
  `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `name` VARCHAR(50) NOT NULL COMMENT '书名',
  `author` VARCHAR(30) NOT NULL COMMENT '作者',
  `price` DOUBLE NOT NULL COMMENT '价格',
  `publish_time` DATE COMMENT '出版时间',
  PRIMARY KEY (`id`)
) ENGINE=INNODB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8;

/*Data for the table `book` */

INSERT  INTO `book`(`id`,`name`,`author`,`price`) VALUES 
(1,'MySQL数据库从入门到精通','王飞飞',59.8),
(2,'设计模式','刘伟',45),
(3,'数据库原理及应用','刘亮',33),
(4,'Linux驱动开发入门与实践','郑强',69),
(5,'Linux驱动开发入门与实践','郑强',69),
(6,'Linux驱动开发入门与实践','郑强',69);

/*Table structure for table `dept` */

DROP TABLE IF EXISTS `dept`;

CREATE TABLE `dept` (
  `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `pid` INT(10) UNSIGNED DEFAULT NULL COMMENT '上级部门ID',
  `name` VARCHAR(30) DEFAULT NULL COMMENT '部门名称',
  `leader` VARCHAR(20) DEFAULT NULL COMMENT '部门领导',
  `phone` VARCHAR(11) DEFAULT NULL COMMENT '联系电话',
  PRIMARY KEY (`id`)
) ENGINE=INNODB AUTO_INCREMENT=108 DEFAULT CHARSET=utf8;

/*Data for the table `dept` */

INSERT  INTO `dept`(`id`,`pid`,`name`,`leader`,`phone`) VALUES 
(100,0,'哪都通','赵方旭','10000000000'),
(101,100,'华北大区','徐四','10000000001'),
(102,100,'东北大区','高廉','10000000002'),
(103,100,'华东大区','窦乐','10000000003'),
(104,100,'华中大区','任菲','10000000004'),
(105,100,'华南大区',NULL,NULL),
(106,100,'西北大区','华风','10000000005'),
(107,100,'西南大区','郝意','10000000006');

/*Table structure for table `emp` */

DROP TABLE IF EXISTS `emp`;

CREATE TABLE `emp` (
  `id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `dept_id` INT(10) UNSIGNED NOT NULL COMMENT '所属部门',
  `name` VARCHAR(30) NOT NULL COMMENT '姓名',
  `gender` TINYINT(1) DEFAULT NULL COMMENT '性别: 0=男 1=女',
  `phone` VARCHAR(11) DEFAULT NULL COMMENT '联系电话',
  `email` VARCHAR(50) DEFAULT NULL COMMENT '邮箱',
  `avatar` VARCHAR(100) DEFAULT NULL COMMENT '照片',
  PRIMARY KEY (`id`)
) ENGINE=INNODB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8;

/*Data for the table `emp` */

INSERT  INTO `emp`(`id`,`dept_id`,`name`,`gender`,`phone`,`email`) VALUES 
(1,100,'赵方旭',0,'10000000000','zhaofx@nadoutong.com'),
(2,100,'毕游龙',0,'10000000007','biyoulong@nadoutong.com'),
(3,100,'黄伯仁',0,'10000000008','huangboren@nadoutong.com'),
(4,101,'徐四',0,'10000000001','xusi@nadoutong.com'),
(5,101,'徐三',0,'10000000009','xusan@nadoutong.com'),
(6,101,'冯宝宝',1,'10000000010','fengbaobao@nadoutong.com'),
(7,101,'张楚岚',0,'10000000011','zhangchulan@nadoutong.com'),
(8,102,'高廉',0,'10000000002','gaolian@nadoutong.com'),
(9,102,'高二壮',1,'10000000012','gaoerzhuang@nadoutong.com'),
(10,103,'窦乐',0,'10000000003','doule@nadoutong.com'),
(11,103,'肖自在',0,'10000000013','xiaozizai@nadoutong.com'),
(12,104,'任菲',0,'10000000004','renfei@nadoutong.com'),
(13,106,'华风',0,'10000000005','huafeng@nadoutong.com'),
(14,107,'郝意',0,'10000000006','huafeng@nadoutong.com');

DROP TABLE IF EXISTS `hobby`;

CREATE TABLE `hobby` (  
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `emp_id` INT UNSIGNED NOT NULL COMMENT 'EmpID',
  `hobby` VARCHAR(50) COMMENT '爱好',
  PRIMARY KEY (`id`) 
) ENGINE=INNODB CHARSET=utf8 COLLATE=utf8_general_ci;

INSERT INTO `hobby` (`id`, `emp_id`, `hobby`) VALUES
(1, 6, '埋人'),
(2, 4, '看美女'),
(3, 7, '月下遛鸟');

DROP TABLE IF EXISTS `user`;

CREATE TABLE `user` (  
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `username` VARCHAR(20) NOT NULL COMMENT '用户名',
  `nickname` VARCHAR(30) COMMENT '昵称',
  `password` VARCHAR(32) COMMENT '密码',
  `avatar` VARCHAR(100) COMMENT '头像',
  `created_at` DATETIME COMMENT '创建时间',
  PRIMARY KEY (`id`) 
) ENGINE=INNODB CHARSET=utf8 COLLATE=utf8_general_ci;

INSERT INTO 
`user` (`id`, `username`, `nickname`, `password`, `avatar`, `created_at`) VALUES
(1, 'libai', '李白', '123456', '', '2023-10-08 16:57:24'),
(2, 'dufu', '杜甫', '123456', '', '2023-10-08 16:57:24'),
(3, 'baijuyi', '白居易', '123456', '', '2023-10-08 16:57:24');</code></pre>
<h2 class="atx" id="数据库配置">数据库配置</h2>
<p>数据库内容准备完毕后，在配置文件中进行数据库配置，只需要添加如下的内容即可</p>
<p><code>manifest/config/config.yaml</code></p>
<pre><code class="fenced-code-block language-yaml"><span class="token key atrule">database</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"mysql"</span>
  <span class="token key atrule">host</span><span class="token punctuation">:</span> <span class="token string">"127.0.0.1"</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token string">"3306"</span>
  <span class="token key atrule">user</span><span class="token punctuation">:</span> <span class="token string">"root"</span>
  <span class="token key atrule">pass</span><span class="token punctuation">:</span> <span class="token string">"root"</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"goframe"</span>
  <span class="token key atrule">timezone</span><span class="token punctuation">:</span> <span class="token string">"Asia/Shanghai"</span>
  <span class="token key atrule">debug</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></code></pre>
<blockquote>
<ul>
<li><code>type</code>：数据库类型 mysql/sqlite/pgsql/oracle等</li>
<li><code>host</code>：数据库主机</li>
<li><code>port</code>：数据库端口</li>
<li><code>user</code>：数据库连接用户名</li>
<li><code>pass</code>：数据库连接密码</li>
<li><code>name</code>：需要连接的数据库名</li>
<li><code>timezone</code>：数据库时区，设置为<code>Asia/Shanghai</code>或者<code>Local</code>，不设置的话会出现时间转换混乱</li>
<li><code>debug</code>：是否开启调试，学习及开发阶段可开启调试，查看数据库操作相关信息输出</li>
</ul>
</blockquote>
<p>以上为连接数据库最简单的配置。如果需要进行更复杂的配置可查阅官方文档<a href="">ORM使用配置</a></p>
<p>上述配置可以简化为一个<code>link</code>，格式为<code>type:user:password@tcp(host:prot)/dbname?param1=value1&amp;..</code></p>
<pre><code class="fenced-code-block language-yaml"><span class="token key atrule">database</span><span class="token punctuation">:</span>
  <span class="token key atrule">debug</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">link</span><span class="token punctuation">:</span> <span class="token string">"mysql:root:root@tcp(127.0.0.1:3306)/goframe?loc=Local&amp;parseTime=true"</span></code></pre>
<p>或者也可以保留上述配置，写为</p>
<pre><code class="fenced-code-block language-yaml"><span class="token key atrule">database</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> <span class="token string">"mysql"</span>
  <span class="token key atrule">host</span><span class="token punctuation">:</span> <span class="token string">"127.0.0.1"</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token string">"3306"</span>
  <span class="token key atrule">user</span><span class="token punctuation">:</span> <span class="token string">"root"</span>
  <span class="token key atrule">pass</span><span class="token punctuation">:</span> <span class="token string">"root"</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"goframe"</span>
  <span class="token key atrule">timezone</span><span class="token punctuation">:</span> <span class="token string">"Local"</span>
  <span class="token key atrule">debug</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">link</span><span class="token punctuation">:</span> <span class="token string">"mysql:root:root@tcp(127.0.0.1:3306)/goframe?loc=Local&amp;parseTime=true"</span></code></pre>
<p>这样的写法使用的是<code>link</code>，其他的单项配置不会生效。</p>
<br>

<h2 class="atx" id="驱动添加与导入">驱动添加与导入</h2>
<ul>
<li>在<code>main.go</code>中进行MySQL驱动初始化导入</li>
</ul>
<pre><code class="fenced-code-block language-go"><span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token boolean">_</span> <span class="token string">"github.com/gogf/gf/contrib/drivers/mysql/v2"</span>
<span class="token punctuation">)</span></code></pre>
<ul>
<li>在<code>go.mod</code>中添加驱动库与版本</li>
</ul>
<pre><code class="fenced-code-block language-go">require <span class="token punctuation">(</span>
    github<span class="token punctuation">.</span>com<span class="token operator">/</span>gogf<span class="token operator">/</span>gf<span class="token operator">/</span>contrib<span class="token operator">/</span>drivers<span class="token operator">/</span>mysql<span class="token operator">/</span>v2 v2<span class="token punctuation">.</span><span class="token number">5.3</span>
    github<span class="token punctuation">.</span>com<span class="token operator">/</span>gogf<span class="token operator">/</span>gf<span class="token operator">/</span>v2 v2<span class="token punctuation">.</span><span class="token number">5.3</span>
<span class="token punctuation">)</span></code></pre>
<ul>
<li>在命令行中进行依赖更新</li>
</ul>
<pre><code class="fenced-code-block language-shell">go mod tidy</code></pre>
<p>等等下载更新完成即可。</p>
<p>至此，在GoFrame中使用数据库的准备工作才准备完毕，正式进入数据库操作部分。</p>
<br>

<h2 class="atx" id="数据库基本操作">数据库基本操作</h2>
<p><code>github.com/gogf/gf/v2/frame/g"</code>包里的<code>Model</code>函数返回一个<code>gdb.Model</code>对象，提供了一系列对数据库的操作。<code>Model</code>函数接收一个参数，为数据表名：</p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span></code></pre>
<p>返回一个与表<code>book</code>关联的<code>Model</code></p>
<h3 class="atx" id="查询数据">查询数据</h3>
<h4 class="atx" id="oneallcountvaluearrayfields">One/All/Count/Value/Array/Fields</h4>
<p><strong>查询数据库中一条数据</strong></p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
bk<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">One</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteJson</span><span class="token punctuation">(</span>bk<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<p>返回数据库中第一条数据。查询成功返回的数据为<code>map[string]*gvar.Var</code>类型，所以可以直接访问里面的每一字段：</p>
<pre><code class="fenced-code-block language-go">req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteJson</span><span class="token punctuation">(</span>bk<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">// 返回结果中"name"字段</span></code></pre>
<p>可以用<code>gvar.Var</code>的方法对字符进行类型转换，转为需要的类型</p>
<pre><code class="fenced-code-block language-go">bk<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 转为string类型</span>
bk<span class="token punctuation">[</span><span class="token string">"price"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">Float32</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 转为float32类型</span></code></pre>
<br>

<p><strong>指定查询字段</strong></p>
<pre><code class="fenced-code-block language-go">bk<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Fields</span><span class="token punctuation">(</span><span class="token string">"name, price"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">One</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//只查询name price两个字符</span>
<span class="token comment">// 也可以写为</span>
bk<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Fields</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"price"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">One</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>查询多条数据</strong></p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
bk<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>该方法以切片返回数据表中所有数据，可以进行循环操作每一条数据</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> bk <span class="token punctuation">{</span>
    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>查询数据数量</strong></p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
count<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>查询一条数据指定字段</strong></p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
name<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Value</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>查询指定列数据</strong></p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
name<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span></code></pre>
<br>

<h4 class="atx" id="maxminsumavg">Max/Min/Sum/Avg</h4>
<p>GoFrame提供了最大最小值、求和、平均等方法</p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>

max<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span>
min<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Min</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span>
sum<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Sum</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span>
avg<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Avg</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span></code></pre>
<h4 class="atx" id="wherewherewhereorwhereor">Where/Where*/WhereOr/WhereOr*</h4>
<p>查询数据时可以通过<code>Where</code>方法指定条件，如果有多个<code>Where</code>，则多个条件之间会用<code>AND</code>连接</p>
<p><strong>等于</strong></p>
<p>默认情况下条件会用<kbd>=</kbd>连接</p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p><strong>不等</strong></p>
<p>如果是不等关系，需要在字段后面加上不等符号</p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"id&gt;"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p><strong>多个条件叠加</strong></p>
<p>有多个条件时可以多个<code>Where</code>进行链式调用，条件会用<code>AND</code>连接。</p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"id&gt;=?"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"id&lt;?"</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>Where系列方法</strong></p>
<table>
<thead>
<tr>
<th align="center">方法</th>
<th align="center">生成的SQL条件表达式</th>
</tr>
</thead>
<tbody><tr>
<td align="center">WhereLT(column, value)</td>
<td align="center">column &lt; value</td>
</tr>
<tr>
<td align="center">WhereLTE(column, value)</td>
<td align="center">column &lt;= value</td>
</tr>
<tr>
<td align="center">WhereGT(column, value)</td>
<td align="center">column &gt; value</td>
</tr>
<tr>
<td align="center">WhereGTE(column, value)</td>
<td align="center">column &gt;= value</td>
</tr>
<tr>
<td align="center">WhereBetween(column, min, max)</td>
<td align="center">column BETWEEN min AND max</td>
</tr>
<tr>
<td align="center">WhereNotBetween(column, min, max)</td>
<td align="center">column NOT BETWEEN min AND max</td>
</tr>
<tr>
<td align="center">WhereLike(column, like)</td>
<td align="center">column LIKE like</td>
</tr>
<tr>
<td align="center">WhereIn(column, in)</td>
<td align="center">column IN (in)</td>
</tr>
<tr>
<td align="center">WhereNotIn(column, in)</td>
<td align="center">column NOT IN (in)</td>
</tr>
<tr>
<td align="center">WhereNot(column, value)</td>
<td align="center">column != value</td>
</tr>
<tr>
<td align="center">WhereNull(columns1, columns2... )</td>
<td align="center">columns1 IS NULL AND columns2 IS NULL...</td>
</tr>
<tr>
<td align="center">WhereNotNull(columns1, columns2... )</td>
<td align="center">columns1 IS NOT NULL AND columns2 IS NOT NULL ...</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
<p>使用示例：</p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">WhereIn</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> g<span class="token punctuation">.</span>Array<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WhereLike</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"%数据%"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 生成如下SQL</span>
<span class="token comment">// SELECT * FROM `book` WHERE (`id` IN (1,2,3)) AND (`name` LIKE '%数据%')</span></code></pre>
<br>

<p>以上方法如果链式调用会生成以<code>AND</code>连接的条件，如果需要生成以<code>OR</code>连接的条件，则需要用到下列方法：</p>
<p><strong>WhereOr系列方法</strong></p>
<table>
<thead>
<tr>
<th align="center">方法</th>
<th align="center">生成的SQL条件表达式</th>
</tr>
</thead>
<tbody><tr>
<td align="center">WhereOrLT(column, value)</td>
<td align="center">OR (column &lt; value)</td>
</tr>
<tr>
<td align="center">WhereOrLTE(column, value)</td>
<td align="center">OR (column &lt;= value)</td>
</tr>
<tr>
<td align="center">WhereOrGT(column, value)</td>
<td align="center">OR  (column &gt; value)</td>
</tr>
<tr>
<td align="center">WhereOrGTE(column, value)</td>
<td align="center">OR (column &gt;= value)</td>
</tr>
<tr>
<td align="center">WhereOrBetween(column, min, max)</td>
<td align="center">OR (column BETWEEN min AND max)</td>
</tr>
<tr>
<td align="center">WhereOrNotBetween(column, min, max)</td>
<td align="center">OR (column NOT BETWEEN min AND max)</td>
</tr>
<tr>
<td align="center">WhereOrLike(column, like)</td>
<td align="center">OR (column LIKE like)</td>
</tr>
<tr>
<td align="center">WhereOrIn(column, in)</td>
<td align="center">OR (column IN (in))</td>
</tr>
<tr>
<td align="center">WhereOrNotIn(column, in)</td>
<td align="center">OR (column NOT IN (in))</td>
</tr>
<tr>
<td align="center">WhereOrNot(column, value)</td>
<td align="center">OR (column != value)</td>
</tr>
<tr>
<td align="center">WhereOrNull(columns1, columns2... )</td>
<td align="center">OR (columns1 IS NULL AND columns2 IS NULL...)</td>
</tr>
<tr>
<td align="center">WhereOrNotNull(columns1, columns2... )</td>
<td align="center">OR (columns1 IS NOT NULL AND columns2 IS NOT NULL ...)</td>
</tr>
<tr>
<td align="center">WhereOr(column, value)</td>
<td align="center">OR (column = value)</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
<p>示例：</p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">WhereIn</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> g<span class="token punctuation">.</span>Array<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WhereOrLike</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"%数据%"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 生成如下SQL</span>
<span class="token comment">// SELECT * FROM `book` WHERE (`id` IN (1,2,3)) OR (`name` LIKE '%数据%')</span></code></pre>
<br>

<br>

<h4 class="atx" id="grouporderorder">Group/Order/Order*</h4>
<p><strong>按字段分组</strong></p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p><strong>按字段排序</strong></p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Order</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">,</span> <span class="token string">"DESC"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 多字段排序</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Order</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">,</span> <span class="token string">"DESC"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Order</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"ASC"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 排序封装方法</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">OrderDesc</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OrderAsc</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<h4 class="atx" id="scan">Scan</h4>
<p><code>One</code>和<code>All</code>返回的数据为<code>Map</code>或者<code>Map</code>切片，在实际使用当中查询到的数据可能需要转换为特定的数据结构方便使用。</p>
<p><code>Scan</code>方法可以将查询到的数据转为自定义结构体或结构体数组。该方法使用方式非常灵活，示例中只演示推荐写法。</p>
<p><strong>查询数据转为自定义结构体</strong></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> Book <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Id          <span class="token builtin">uint</span>
    Name        <span class="token builtin">string</span>
    Author      <span class="token builtin">string</span>
    Price       <span class="token builtin">float64</span>
    PublishTime <span class="token operator">*</span>gtime<span class="token punctuation">.</span>Time
<span class="token punctuation">}</span>

<span class="token keyword">var</span> book <span class="token operator">*</span>Book

md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>book<span class="token punctuation">)</span></code></pre>
<p><code>Scan</code>会将数据库字段下划线命名对应到结构体中相应的驼峰命名上，如果对应不上，则该成员为<code>nil</code>或者零值。如果结构体中成员名称与数据表中字段不对应，可以用<code>orm:</code>标签来指定对应字段</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> Book <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    BookId     <span class="token builtin">uint</span>        <span class="token string">`orm:"id"  `</span>
    BookName   <span class="token builtin">string</span>      <span class="token string">`orm:"name"`</span>
    BookAuthor <span class="token builtin">string</span>      <span class="token string">`orm:"author"`</span>
    BookPrice  <span class="token builtin">float64</span>     <span class="token string">`orm:"price"`</span>
    PubTime    <span class="token operator">*</span>gtime<span class="token punctuation">.</span>Time <span class="token string">`orm:"publish_time"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> book <span class="token operator">*</span>Book

md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>book<span class="token punctuation">)</span></code></pre>
<p><strong>结构体数组</strong></p>
<p><code>Scan</code>方法可以查询单独结构体，如上，也可以查询一个结构体数组，只需要将结构体指针改为结构体切片传入即可</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> Book <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Id          <span class="token builtin">uint</span>
    Name        <span class="token builtin">string</span>
    Author      <span class="token builtin">string</span>
    Price       <span class="token builtin">float64</span>
    PublishTime <span class="token operator">*</span>gtime<span class="token punctuation">.</span>Time
<span class="token punctuation">}</span>

<span class="token keyword">var</span> book <span class="token punctuation">[</span><span class="token punctuation">]</span>Book

md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>book<span class="token punctuation">)</span></code></pre>
<p>查询结果为一个由<code>Book</code>组成的结构体数组，存放多条数据。</p>
<br>

<p>查询部分暂时就先了解这些，实际上只要SQL熟悉的话每种查询基本上都能找到对应的方法来实现。更复杂的查询见官方文档<a href="">ORM查询</a></p>
<h4 class="atx" id="查询结果为空判断">查询结果为空判断</h4>
<p><strong>All</strong></p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
books<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>books<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span><span class="token function">RequestFromCtx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"结果为空"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 或者</span>
<span class="token keyword">if</span> books<span class="token punctuation">.</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span><span class="token function">RequestFromCtx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"结果为空"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>One</strong></p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
book<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">One</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span><span class="token function">RequestFromCtx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"结果为空"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 或者</span>
<span class="token keyword">if</span> book<span class="token punctuation">.</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span><span class="token function">RequestFromCtx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"结果为空"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>Value</strong></p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
name<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Value</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> name<span class="token punctuation">.</span><span class="token function">IsEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span><span class="token function">RequestFromCtx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"结果为空"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>Array</strong></p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
names<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">WhereLT</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Array</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">{</span>
    g<span class="token punctuation">.</span><span class="token function">RequestFromCtx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"结果为空"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>Scan结构体对象</strong></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">var</span> book <span class="token operator">*</span>Book
md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
md<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>book<span class="token punctuation">)</span>
<span class="token keyword">if</span> book <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span><span class="token function">RequestFromCtx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"结果为空"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
md<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></code></pre>
<br>

<p><strong>Scan结构体数组</strong></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">var</span> books <span class="token punctuation">[</span><span class="token punctuation">]</span>Book
md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
md<span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>books<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token function">len</span><span class="token punctuation">(</span>books<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span><span class="token function">RequestFromCtx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"结果为空"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<br>

<h4 class="atx" id="分页">分页</h4>
<p>GoFrame中提供了<code>Page</code>方法可以很方便实现分页查询，只需提供页数和每页数据数量即可。</p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Page</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>也有<code>Limit</code>方法可以用来限制查询条数以及自定义起始位置与数据限制</p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
<span class="token comment">// 限制条数</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Limit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 指定起始位置与限制条数</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Limit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<h3 class="atx" id="插入数据">插入数据</h3>
<h4 class="atx" id="insertreplacesave">Insert/Replace/Save</h4>
<p>这三个方法都可以向数据库中写入一条或者多条数据，区别在于当数据中主键字段在数据库中已经存在时，处理方式不同：</p>
<table>
<thead>
<tr>
<th align="center">方法</th>
<th align="center">主键在数据库中已存在时</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Insert</td>
<td align="center">报错，主键冲突</td>
</tr>
<tr>
<td align="center">Repalce</td>
<td align="center">用提供的数据替换已存在同主键的数据</td>
</tr>
<tr>
<td align="center">Save</td>
<td align="center">用提供的数据更新已存在的同主键数据</td>
</tr>
</tbody></table>
<p><strong>写入单条数据</strong></p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
data <span class="token operator">:=</span> g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span>
    <span class="token string">"id"</span><span class="token punctuation">:</span>           <span class="token number">8</span><span class="token punctuation">,</span>
    <span class="token string">"name"</span><span class="token punctuation">:</span>         <span class="token string">"Linux驱动开发入门与实践"</span><span class="token punctuation">,</span>
    <span class="token string">"author"</span><span class="token punctuation">:</span>       <span class="token string">"郑强"</span><span class="token punctuation">,</span>
    <span class="token string">"price"</span><span class="token punctuation">:</span>        <span class="token number">69</span><span class="token punctuation">,</span>
    <span class="token string">"publish_time"</span><span class="token punctuation">:</span> <span class="token string">"2023-10-10"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">// Insert</span>
result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token comment">// Replace</span>
result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token comment">// Save</span>
result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></code></pre>
<p>以上方法也可配合<code>Data</code>使用</p>
<pre><code class="fenced-code-block language-go"><span class="token comment">// Insert</span>
result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// Replace</span>
result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Replace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// Save</span>
result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>除了使用<code>Map</code>类型之外，还可以用结构体。结构体成员名称与数据表字段名称不对应时，用<code>orm</code>标签指定</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> Book <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Id      <span class="token builtin">uint</span>
    Name    <span class="token builtin">string</span>
    Author  <span class="token builtin">string</span>
    Price   <span class="token builtin">float64</span>
    PubTime <span class="token operator">*</span>gtime<span class="token punctuation">.</span>Time <span class="token string">`orm:"publish_time"`</span>
<span class="token punctuation">}</span>


md <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span>
data <span class="token operator">:=</span> Book<span class="token punctuation">{</span>
    Id<span class="token punctuation">:</span>      <span class="token number">8</span><span class="token punctuation">,</span>
    Name<span class="token punctuation">:</span>    <span class="token string">"Linux驱动开发入门与实践"</span><span class="token punctuation">,</span>
    Author<span class="token punctuation">:</span>  <span class="token string">"郑强"</span><span class="token punctuation">,</span>
    Price<span class="token punctuation">:</span>   <span class="token number">69.3</span><span class="token punctuation">,</span>
    PubTime<span class="token punctuation">:</span> gtime<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"2023-10-10"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>批量写入数据</strong></p>
<p>上述方法也可以批量写入数据</p>
<pre><code class="fenced-code-block language-go">data <span class="token operator">:=</span> g<span class="token punctuation">.</span>List<span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span>
        <span class="token string">"name"</span><span class="token punctuation">:</span>         <span class="token string">"Linux驱动开发入门与实践"</span><span class="token punctuation">,</span>
        <span class="token string">"author"</span><span class="token punctuation">:</span>       <span class="token string">"郑强"</span><span class="token punctuation">,</span>
        <span class="token string">"price"</span><span class="token punctuation">:</span>        <span class="token number">69.3</span><span class="token punctuation">,</span>
        <span class="token string">"publish_time"</span><span class="token punctuation">:</span> gtime<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"2023-10-10"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span>
        <span class="token string">"name"</span><span class="token punctuation">:</span>         <span class="token string">"Linux驱动开发入门与实践"</span><span class="token punctuation">,</span>
        <span class="token string">"author"</span><span class="token punctuation">:</span>       <span class="token string">"郑强"</span><span class="token punctuation">,</span>
        <span class="token string">"price"</span><span class="token punctuation">:</span>        <span class="token number">69.3</span><span class="token punctuation">,</span>
        <span class="token string">"publish_time"</span><span class="token punctuation">:</span> gtime<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"2023-10-10"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span>
        <span class="token string">"name"</span><span class="token punctuation">:</span>         <span class="token string">"Linux驱动开发入门与实践"</span><span class="token punctuation">,</span>
        <span class="token string">"author"</span><span class="token punctuation">:</span>       <span class="token string">"郑强"</span><span class="token punctuation">,</span>
        <span class="token string">"price"</span><span class="token punctuation">:</span>        <span class="token number">69.3</span><span class="token punctuation">,</span>
        <span class="token string">"publish_time"</span><span class="token punctuation">:</span> gtime<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"2023-10-10"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>如果使用的是结构体，将<code>g.List</code>改为<code>g.Array</code>或者<code>g.Slice</code></p>
<br>

<h4 class="atx" id="insertandgetid">InsertAndGetId</h4>
<p>写入数据并返回自增ID</p>
<pre><code class="fenced-code-block language-go">data <span class="token operator">:=</span> g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span>
    <span class="token string">"name"</span><span class="token punctuation">:</span>         <span class="token string">"Linux驱动开发入门与实践"</span><span class="token punctuation">,</span>
    <span class="token string">"author"</span><span class="token punctuation">:</span>       <span class="token string">"郑强"</span><span class="token punctuation">,</span>
    <span class="token string">"price"</span><span class="token punctuation">:</span>        <span class="token number">69.3</span><span class="token punctuation">,</span>
    <span class="token string">"publish_time"</span><span class="token punctuation">:</span> gtime<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"2023-10-10"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">InsertAndGetId</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<h4 class="atx" id="gdbraw">gdb.Raw</h4>
<p>对于有的字段，可能需要调用SQL里面的操作来获得结果，例如，<code>publish_time</code>字段可以用SQL中的<code>CURRENT_DATE()</code>来获取当前日期，这时就需要用到<code>Raw</code>：</p>
<pre><code class="fenced-code-block language-go">data <span class="token operator">:=</span> g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span>
    <span class="token string">"name"</span><span class="token punctuation">:</span>         <span class="token string">"Linux驱动开发入门与实践"</span><span class="token punctuation">,</span>
    <span class="token string">"author"</span><span class="token punctuation">:</span>       <span class="token string">"郑强"</span><span class="token punctuation">,</span>
    <span class="token string">"price"</span><span class="token punctuation">:</span>        <span class="token number">69.3</span><span class="token punctuation">,</span>
    <span class="token string">"publish_time"</span><span class="token punctuation">:</span> gdb<span class="token punctuation">.</span><span class="token function">Raw</span><span class="token punctuation">(</span><span class="token string">"CURRENT_DATE()"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">InsertAndGetId</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<h3 class="atx" id="更新数据">更新数据</h3>
<h4 class="atx" id="update">Update</h4>
<pre><code class="fenced-code-block language-go">data <span class="token operator">:=</span> g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span>
    <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token string">"郑强强"</span><span class="token punctuation">,</span>
    <span class="token string">"price"</span><span class="token punctuation">:</span>  <span class="token number">69.333</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"author"</span><span class="token punctuation">,</span> <span class="token string">"郑强"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></code></pre>
<p>也可以配合<code>Data</code>使用</p>
<pre><code class="fenced-code-block language-go">data <span class="token operator">:=</span> g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span>
    <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token string">"郑强强"</span><span class="token punctuation">,</span>
    <span class="token string">"price"</span><span class="token punctuation">:</span>  <span class="token number">69.333</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"author"</span><span class="token punctuation">,</span> <span class="token string">"郑强"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<h4 class="atx" id="incrementdecrement">Increment/Decrement</h4>
<p>用来给指定字段增加/减少指定值</p>
<pre><code class="fenced-code-block language-go">result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">WhereBetween</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Increment</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span>
result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">WhereBetween</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Decrement</span><span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span></code></pre>
<br>

<h3 class="atx" id="删除数据">删除数据</h3>
<pre><code class="fenced-code-block language-go">result<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">WhereGT</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<h2 class="atx" id="时间维护与软删除">时间维护与软删除</h2>
<p>在实际应用当中，数据表中通常会有三个时间字段：创建时间、更新时间、删除时间。GoFrame支持这三个时间字段的自动填充，这三个字段支持的类型为<code>DATE</code>、<code>DATETIME</code>、<code>TIMESTAMP</code>。</p>
<ul>
<li>创建时间：默认为<code>created_at</code></li>
<li>更新时间：默认为<code>updated_at</code></li>
<li>删除时间：默认为<code>deleted_at</code>，数据软删除时使用</li>
</ul>
<p>如果不想使用默认名称，需要自行修改，可以在配置文件里数据库配置时修改，方式如下：</p>
<pre><code class="fenced-code-block language-yam">database:
    ....
    createdAt: "create_time"
    updatedAt: "update_time"
    deletedAt: "delete_time"</code></pre>
<br>

<p><strong>软删除</strong></p>
<blockquote>
<p>软删除并不是真正从数据库中把记录删除，而是通过特定的标记在查询时过滤掉这些数据，使这些数据在页面上看不到，但实际上在数据库中仍然存在。通常用于一些需要历史追踪而不能真正删除的数据。</p>
</blockquote>
<p>当数据表中有<code>deleted_at</code>字段时，使用<code>Delete</code>方法时不会物理删除数据，只是更新<code>deleted_at</code>字段的值。查询数据时，会自动加上<kbd>WHERE `deleted_at`&nbsp;IS NULL</kbd>这一条件，过滤掉已被“删除”的数据。</p>
<p>如果需要查询所有数据，需要使用<code>Unscoped</code>方法</p>
<pre><code class="fenced-code-block language-go">ls<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">Unscoped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<h2 class="atx" id="事务处理">事务处理</h2>
<p><strong>常规写法</strong></p>
<pre><code class="fenced-code-block language-go">tx<span class="token punctuation">,</span> err <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">DB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Begin</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>

<span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> tx<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        tx<span class="token punctuation">.</span><span class="token function">Commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        tx<span class="token punctuation">.</span><span class="token function">Rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>闭包写法</strong>(框架建议写法)</p>
<pre><code class="fenced-code-block language-go">g<span class="token punctuation">.</span><span class="token function">DB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Transaction</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> tx gdb<span class="token punctuation">.</span>TX<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> tx<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token keyword">return</span> err
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<br>

<h2 class="atx" id="原生sql的使用">原生SQL的使用</h2>
<p>由<code>Model</code>提供的方法能组合出绝大多数使用场景所需要的数据操作，但如果需要的操作过于复杂，可能就没法通过已有的方法组合出来，就需要使用写SQL来实现</p>
<p><strong>查询</strong></p>
<pre><code class="fenced-code-block language-go">db <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">DB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Query</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">"SELECT * FROM `book` WHERE `id` &gt; ? AND `id` &lt; ?"</span><span class="token punctuation">,</span> g<span class="token punctuation">.</span>Array<span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p><strong>新增数据</strong></p>
<pre><code class="fenced-code-block language-go">db <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">DB</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
sql <span class="token operator">:=</span> <span class="token string">"INSERT INTO `book` (`name`, `author`, `price`) VALUES (?, ?, ?)"</span>
data <span class="token operator">:=</span> g<span class="token punctuation">.</span>Array<span class="token punctuation">{</span><span class="token string">"Go语言从入门到精通"</span><span class="token punctuation">,</span> <span class="token string">"Go语言研讨组"</span><span class="token punctuation">,</span> <span class="token number">99.98</span><span class="token punctuation">}</span>
result<span class="token punctuation">,</span> err <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Exec</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> data<span class="token punctuation">)</span></code></pre>
<p>更多操作查看官方文档<a href="">ORM方法操作(原生)</a></p>
<br>

<br>

<h2 class="atx" id="dao自动生成与使用">DAO自动生成与使用</h2>
<p>数据库相关的操作与数据结构放在<code>dao</code>与<code>model</code>中，在GoFrame中，<code>dao</code>与<code>model</code>的内容可以自动生成。生成步骤如下：</p>
<ol>
<li>配置<code>dao</code></li>
</ol>
<p><code>hack/comfig.yaml</code></p>
<pre><code class="fenced-code-block language-yaml"><span class="token key atrule">gfcli</span><span class="token punctuation">:</span>
  <span class="token key atrule">gen</span><span class="token punctuation">:</span>
    <span class="token key atrule">dao</span><span class="token punctuation">:</span>
      <span class="token key atrule">link</span><span class="token punctuation">:</span> <span class="token string">"mysql:root:root@tcp(127.0.0.1:3306)/goframe"</span>
      <span class="token key atrule">tables</span><span class="token punctuation">:</span> <span class="token string">"book, user, dept, emp, hobby"</span>
      <span class="token key atrule">jsonCase</span><span class="token punctuation">:</span> <span class="token string">"Snake"</span></code></pre>
<blockquote>
<ul>
<li>link: 数据库连接url</li>
<li>tables: 需要生成dao及model的数据表，多个表用逗号隔开</li>
<li>jsonCase: entity成员转为json时的转换方式，"Snake"为把驼峰转为下划线</li>
</ul>
</blockquote>
<p>以上为最简单配置，更多配置见官方文档<a href="">代码生成/数据规范 gen dao</a>章节</p>
<ol start="2">
<li>在命令行中执行如下命令</li>
</ol>
<pre><code class="fenced-code-block language-shell">gf gen dao</code></pre>
<p>该命令会生成<code>dao</code>以及<code>model</code>下各个表对应的结构与代码。</p>
<p>接下来使用各个表对应的Model对象时，不再用<code>g.Model</code>获取，而是用下面的的方式：</p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>该Model对象可以多次叠加查询条件：</p>
<pre><code class="fenced-code-block language-go">md <span class="token operator">:=</span> dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
md <span class="token operator">=</span> md<span class="token punctuation">.</span><span class="token function">WhereGT</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
md <span class="token operator">=</span> md<span class="token punctuation">.</span><span class="token function">WhereLT</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> md<span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 以上代码相当于</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WhereGT</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WhereLT</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<h2 class="atx" id="字段过滤">字段过滤</h2>
<p>使用结构体数据进行创建或更新数据时，尤其是在更新数据的时候，有些字段可能不需要更新，因此对应的字段就不进行赋值，例如以下代码</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> Book <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Id      <span class="token builtin">uint</span>
    Name    <span class="token builtin">string</span>
    Author  <span class="token builtin">string</span>
    Price   <span class="token builtin">float64</span>
    PubTime <span class="token operator">*</span>gtime<span class="token punctuation">.</span>Time <span class="token string">`orm:"publish_time"`</span>
<span class="token punctuation">}</span>

data <span class="token operator">:=</span> Book<span class="token punctuation">{</span>
    Name<span class="token punctuation">:</span>    <span class="token string">"Linux驱动开发入门与实践"</span><span class="token punctuation">,</span>
    PubTime<span class="token punctuation">:</span> gtime<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"2023-10-11"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>直接这样更新，则<code>id</code>、<code>author</code>、<code>price</code>也会被对应类型的零值更新，分别被更新为0、""、0</p>
<p>要解决这样的问题，有以下几种解决方案：</p>
<br>

<p><strong>用Fields指定需要更新的字段</strong></p>
<pre><code class="fenced-code-block language-go">dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Fields</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"publish_time"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>用FieldsEx排除不需要更新的字段</strong></p>
<pre><code class="fenced-code-block language-go">dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">FieldsEx</span><span class="token punctuation">(</span><span class="token string">"id,author,price"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>用OmitEmpty过滤空值</strong></p>
<pre><code class="fenced-code-block language-go">data <span class="token operator">:=</span> Book<span class="token punctuation">{</span>
    Name<span class="token punctuation">:</span>    <span class="token string">"Linux驱动开发入门与实践"</span><span class="token punctuation">,</span>
    Price<span class="token punctuation">:</span>   <span class="token number">0</span><span class="token punctuation">,</span>
    PubTime<span class="token punctuation">:</span> <span class="token boolean">nil</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">OmitEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>用这种方法如上数据中，0和<code>nil</code>也会被忽略，没法更新对应字段的值。</p>
<br>

<p><strong>使用do对象进行字段过滤</strong></p>
<p>使用<code>gf gen dao</code>时，每个表会生成一个对应的<code>do</code>对象，使用<code>do</code>对象作为参数传递，将会自动过滤空值</p>
<pre><code class="fenced-code-block language-go">data <span class="token operator">:=</span> do<span class="token punctuation">.</span>Book<span class="token punctuation">{</span>
    Name<span class="token punctuation">:</span>        <span class="token string">"Linux驱动开发入门与实践"</span><span class="token punctuation">,</span>
    Price<span class="token punctuation">:</span>       <span class="token number">0</span><span class="token punctuation">,</span>
    PublishTime<span class="token punctuation">:</span> <span class="token boolean">nil</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>使用这种方法，非<code>nil</code>的零值都可以更新。</p>
<p><code>do</code>对象也可以用于传递查询条件， 也会自动过滤空值</p>
<pre><code class="fenced-code-block language-go">where <span class="token operator">:=</span> do<span class="token punctuation">.</span>Book<span class="token punctuation">{</span>
    Author<span class="token punctuation">:</span>      <span class="token string">"郑强"</span><span class="token punctuation">,</span>
    Id<span class="token punctuation">:</span>          <span class="token number">13</span><span class="token punctuation">,</span>
    PublishTime<span class="token punctuation">:</span> <span class="token boolean">nil</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

books<span class="token punctuation">,</span> err <span class="token operator">:=</span> dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>where<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 相当于</span>
books<span class="token punctuation">,</span> err <span class="token operator">:=</span> dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"author"</span><span class="token punctuation">,</span> <span class="token string">"郑强"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">All</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<h2 class="atx" id="关联查询">关联查询</h2>
<p>多表数据联查时可以用连接，但是数据量大时连接效率不高，GoFrame中提供了模型关联查询，可以简化一些多表联查操作。</p>
<p>以<code>dept</code>、<code>emp</code>、<code>hobby</code>三个表为例，每个部门可以有多个员工，每个员工只有一个部门，每个员工对应一条爱好。</p>
<p><strong>查询所有员工，并关联查询出其所在部门</strong></p>
<ul>
<li>修改<code>entity.Emp</code>，加入关联信息</li>
</ul>
<p><code>internal/model/entity/emp.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> Emp <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Id     <span class="token builtin">uint</span>   <span class="token string">`json:"id"      `</span> <span class="token comment">// ID</span>
    DeptId <span class="token builtin">uint</span>   <span class="token string">`json:"dept_id" `</span> <span class="token comment">// 所属部门</span>
    Name   <span class="token builtin">string</span> <span class="token string">`json:"name"    `</span> <span class="token comment">// 姓名</span>
    Gender <span class="token builtin">int</span>    <span class="token string">`json:"gender"  `</span> <span class="token comment">// 性别: 0=男 1=女</span>
    Phone  <span class="token builtin">string</span> <span class="token string">`json:"phone"   `</span> <span class="token comment">// 联系电话</span>
    Email  <span class="token builtin">string</span> <span class="token string">`json:"email"   `</span> <span class="token comment">// 邮箱</span>
    Avatar <span class="token builtin">string</span> <span class="token string">`json:"avatar"  `</span> <span class="token comment">// 照片</span>

    Dept <span class="token operator">*</span>Dept    <span class="token string">`orm:"with:id=dept_id" json:"dept"`</span>
<span class="token punctuation">}</span></code></pre>
<ul>
<li>使用<code>With</code>指定关联模型查询</li>
</ul>
<pre><code class="fenced-code-block language-go"><span class="token keyword">var</span> emps <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>entity<span class="token punctuation">.</span>Emp
err <span class="token operator">=</span> dao<span class="token punctuation">.</span>Emp<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">With</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>Dept<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>emps<span class="token punctuation">)</span></code></pre>
<p>不用<code>With</code>指定关联的话，查询出的结果中<code>Dept</code>为<code>nil</code></p>
<br>

<p><strong>查询所有员工，并关联查询出部门与爱好</strong></p>
<ul>
<li>修改<code>entity.Emp</code>，加入关联信息</li>
</ul>
<p><code>internal/model/entity/emp.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> Emp <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Id     <span class="token builtin">uint</span>   <span class="token string">`json:"id"      `</span> <span class="token comment">// ID</span>
    DeptId <span class="token builtin">uint</span>   <span class="token string">`json:"dept_id" `</span> <span class="token comment">// 所属部门</span>
    Name   <span class="token builtin">string</span> <span class="token string">`json:"name"    `</span> <span class="token comment">// 姓名</span>
    Gender <span class="token builtin">int</span>    <span class="token string">`json:"gender"  `</span> <span class="token comment">// 性别: 0=男 1=女</span>
    Phone  <span class="token builtin">string</span> <span class="token string">`json:"phone"   `</span> <span class="token comment">// 联系电话</span>
    Email  <span class="token builtin">string</span> <span class="token string">`json:"email"   `</span> <span class="token comment">// 邮箱</span>
    Avatar <span class="token builtin">string</span> <span class="token string">`json:"avatar"  `</span> <span class="token comment">// 照片</span>

    Dept <span class="token operator">*</span>Dept    <span class="token string">`orm:"with:id=dept_id" json:"dept"`</span>
    Hobby <span class="token operator">*</span>Hobby <span class="token string">`orm:"with:emp_id=id" json:"hobby"`</span>
<span class="token punctuation">}</span></code></pre>
<ul>
<li>使用<code>With</code>指定需要关联的内容</li>
</ul>
<pre><code class="fenced-code-block language-go"><span class="token keyword">var</span> emps <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>entity<span class="token punctuation">.</span>Emp
err <span class="token operator">=</span> dao<span class="token punctuation">.</span>Emp<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">With</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>Dept<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> entity<span class="token punctuation">.</span>Hobby<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"dept_id"</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>emps<span class="token punctuation">)</span></code></pre>
<p>也可以用<code>WithAll</code>关联所有</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">var</span> emps <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>entity<span class="token punctuation">.</span>Emp
err <span class="token operator">=</span> dao<span class="token punctuation">.</span>Emp<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WithAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"dept_id"</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>emps<span class="token punctuation">)</span></code></pre>
<br>

<p><strong>查询部门，关联查询出每个部门的员工</strong></p>
<ul>
<li>修改<code>entity.Dept</code>，加入关联信息</li>
</ul>
<p><code>internal/model/entity/dept.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token comment">// Dept is the golang structure for table dept.</span>
<span class="token keyword">type</span> Dept <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Id     <span class="token builtin">uint</span>   <span class="token string">`json:"id"     `</span> <span class="token comment">// ID</span>
    Pid    <span class="token builtin">uint</span>   <span class="token string">`json:"pid"    `</span> <span class="token comment">// 上级部门ID</span>
    Name   <span class="token builtin">string</span> <span class="token string">`json:"name"   `</span> <span class="token comment">// 部门名称</span>
    Leader <span class="token builtin">string</span> <span class="token string">`json:"leader" `</span> <span class="token comment">// 部门领导</span>
    Phone  <span class="token builtin">string</span> <span class="token string">`json:"phone"  `</span> <span class="token comment">// 联系电话</span>

    Emps <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>Emp      <span class="token string">`orm:"with:dept_id=id" json:"emps"`</span>
<span class="token punctuation">}</span></code></pre>
<ul>
<li>查询</li>
</ul>
<pre><code class="fenced-code-block language-go"><span class="token keyword">var</span> depts <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>entity<span class="token punctuation">.</span>Dept
err <span class="token operator">=</span> dao<span class="token punctuation">.</span>Dept<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">With</span><span class="token punctuation">(</span>entity<span class="token punctuation">.</span>Emp<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>depts<span class="token punctuation">)</span></code></pre>
<br>

<p>上述关联查询直接在实体类里面修改，但实体类里的内容是用工具自动生成的，一般情况下不要修改。所以在进行关联查询时，需要重新自定义结构体，只需要保留需要查询的字段即可（用于关联的字段必须存在）</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> MyDept <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta <span class="token string">`orm:"table:dept"`</span>
    Id     <span class="token builtin">uint</span>   <span class="token string">`json:"id"     `</span> <span class="token comment">// ID</span>
    Name   <span class="token builtin">string</span> <span class="token string">`json:"name"   `</span> <span class="token comment">// 部门名称</span>
    Leader <span class="token builtin">string</span> <span class="token string">`json:"leader" `</span> <span class="token comment">// 部门领导</span>
    Phone  <span class="token builtin">string</span> <span class="token string">`json:"phone"  `</span> <span class="token comment">// 联系电话</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> MyEmp <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta <span class="token string">`orm:"table:emp"`</span>
    Id     <span class="token builtin">uint</span>   <span class="token string">`json:"id"      `</span> <span class="token comment">// ID</span>
    DeptId <span class="token builtin">uint</span>   <span class="token string">`json:"dept_id" `</span> <span class="token comment">// 所属部门</span>
    Name   <span class="token builtin">string</span> <span class="token string">`json:"name"    `</span> <span class="token comment">// 姓名</span>
    Phone  <span class="token builtin">string</span> <span class="token string">`json:"phone"   `</span> <span class="token comment">// 联系电话</span>

    Dept <span class="token operator">*</span>MyDept <span class="token string">`orm:"with:id=dept_id" json:"dept"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> emps <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>MyEmp
err <span class="token operator">=</span> dao<span class="token punctuation">.</span>Emp<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">With</span><span class="token punctuation">(</span>MyDept<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>emps<span class="token punctuation">)</span></code></pre>
<p>自定义结构体时，需要用<code>g.Meta</code>及<code>orm</code>标签指定对应的数据表</p>
<br>

<br>

<h1 class="atx" id="模板引擎">模板引擎</h1>
<p>前面我们提过可以用下面几个方法返回模板内容</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">WriteTpl</span><span class="token punctuation">(</span>tpl <span class="token builtin">string</span><span class="token punctuation">,</span> params <span class="token operator">...</span>gview<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token builtin">error</span> 
<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">WriteTplDefault</span><span class="token punctuation">(</span>params <span class="token operator">...</span>gview<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token builtin">error</span> 
<span class="token keyword">func</span> <span class="token punctuation">(</span>r <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token function">WriteTplContent</span><span class="token punctuation">(</span>content <span class="token builtin">string</span><span class="token punctuation">,</span> params <span class="token operator">...</span>gview<span class="token punctuation">.</span>Params<span class="token punctuation">)</span> <span class="token builtin">error</span></code></pre>
<p>默认情况下模板文件目录是<code>resource/template</code></p>
<ul>
<li><code>WriteTpl</code>解析并返回模板文件内容，文件为相对于<code>resource/template</code>的路径</li>
<li><code>WriteTplDefault</code>解析并返回默认模板，为<code>resource/template/index.html</code></li>
<li><code>WriteTplContent</code>解析并返回模板字符串</li>
</ul>
<p>常用的为<code>WriteTpl</code>，其他两个方法简单了解即可</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Tpl</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteTplDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 解析并返回默认模板文件内容</span>
    <span class="token comment">// 解析并返回模板字符串</span>
    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteTplContent</span><span class="token punctuation">(</span><span class="token string">"&lt;h1&gt;你好, {{.name}} 欢迎学习{{.lang}}&lt;/h1&gt;"</span><span class="token punctuation">,</span> g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"王道长"</span><span class="token punctuation">,</span> <span class="token string">"lang"</span><span class="token punctuation">:</span> <span class="token string">"GoFrame"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<br>

<h2 class="atx" id="简单使用示例">简单使用示例</h2>
<p><code>resource/template/hello/index.html</code></p>
<pre><code class="fenced-code-block language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zh<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>你好， {{.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>欢迎来到{{.lesson}}的学习课程<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>本课程共{{.num}}小节，现在学习的是{{.what}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><code>controller</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Tpl</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data <span class="token operator">:=</span> g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span>
        <span class="token string">"name"</span><span class="token punctuation">:</span>   <span class="token string">"王也道长"</span><span class="token punctuation">,</span>
        <span class="token string">"lesson"</span><span class="token punctuation">:</span> <span class="token string">"GoFrame入门课程"</span><span class="token punctuation">,</span>
        <span class="token string">"num"</span><span class="token punctuation">:</span>    <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token string">"what"</span><span class="token punctuation">:</span>   <span class="token string">"模板引擎使用示例"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteTpl</span><span class="token punctuation">(</span><span class="token string">"hello/index.html"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<br>

<h2 class="atx" id="模板配置">模板配置</h2>
<p>模板使用当中一般情况使用默认配置即可，如果需要修改配置，则在<code>manifest/config/config.yaml</code>中进行修改</p>
<pre><code class="fenced-code-block language-yaml"><span class="token key atrule">viewer</span><span class="token punctuation">:</span> <span class="token comment"># 模板配置</span>
  <span class="token key atrule">paths</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"resource/template"</span><span class="token punctuation">,</span> <span class="token string">"/www/template"</span><span class="token punctuation">]</span> <span class="token comment"># 模板路径配置，可以配置多个路径</span>
  <span class="token key atrule">defaultFile</span><span class="token punctuation">:</span> <span class="token string">"index.hmtl"</span> <span class="token comment"># WriteTplDefault解析的文件</span>
  <span class="token key atrule">delimiters</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"${"</span><span class="token punctuation">,</span> <span class="token string">"}"</span><span class="token punctuation">]</span> <span class="token comment"># 模板引擎变量分隔符，默认为["{{", "}}"]</span></code></pre>
<br>

<h2 class="atx" id="静态资源">静态资源</h2>
<p>静态资源不属于模板引擎的内容，但在模板文件中也有需要用到静态资源的地方，因此进行一下补充。</p>
<p>静态资源一般指的是js/css/image文件或者静态HTML文件，在GoFrame的项目目录中，这些文件放在<code>resource/public</code>下，之后还需要开启静态资源服务才能在模板文件中对这些资源进行引用。开启方式有两种</p>
<ul>
<li>配置文件</li>
</ul>
<p><code>manifest/config/config.yaml</code></p>
<pre><code class="fenced-code-block language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>

  <span class="token key atrule">serverRoot</span><span class="token punctuation">:</span>  <span class="token string">"resource/public"</span>
  <span class="token key atrule">indexFolder</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 这个可以不用配置，放在这里了解一下</span></code></pre>
<ul>
<li>用代码开启</li>
</ul>
<p><code>internal/cmd/cmd.go</code></p>
<pre><code class="fenced-code-block language-go">s <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Server</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">SetServerRoot</span><span class="token punctuation">(</span><span class="token string">"resource/public"</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">SetIndexFolder</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span></code></pre>
<p><code>serverRoot</code>配置了静态资源根目录<code>resource/public</code>，对静态资源的引用url以<code>resource/public</code>为根目录</p>
<p>例如，在<code>resource/public/resource/css</code>中放置了一人<code>bootstrap.css</code>文件，引用时写为</p>
<pre><code class="fenced-code-block language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/resource/css/bootstrap.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></code></pre>
<br>

<h2 class="atx" id="条件判断">条件判断</h2>
<p>在模板中可以进行条件判断，根据条件是否满足来显示不同内容，语法如下：</p>
<pre><code class="fenced-code-block language-html">{{if .condition}}
条件满足时显示内容
{{else}}
条件不满足时显示内容
{{end}}</code></pre>
<p>可以嵌套写，也可以写多个{{else if  .condition}}</p>
<p>当<code>.condition</code>为空值，即<code>0</code>、<code>""</code>、<code>nil</code>这类值时，条件判断为假，其他值均为真（条件满足）。</p>
<p>用法示例：</p>
<p><code>resource/template/hello/index.html</code></p>
<pre><code class="fenced-code-block language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zh<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/resource/css/bootstrap.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

   {{if .name}}
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>name的值: {{.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
   {{else}}
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>name的值为false/""/0/nil等<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
   {{end}}

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><code>controller</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Tpl</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data <span class="token operator">:=</span> g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span>
        <span class="token string">"name"</span><span class="token punctuation">:</span>   <span class="token string">"王也道长"</span><span class="token punctuation">,</span>
        <span class="token string">"lesson"</span><span class="token punctuation">:</span> <span class="token string">"GoFrame入门课程"</span><span class="token punctuation">,</span>
        <span class="token string">"num"</span><span class="token punctuation">:</span>    <span class="token number">5</span><span class="token punctuation">,</span>
        <span class="token string">"what"</span><span class="token punctuation">:</span>   <span class="token string">"模板引擎使用示例"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteTpl</span><span class="token punctuation">(</span><span class="token string">"hello/index.html"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>大于小于等于判断</strong></p>
<p>在模板中无法直接使用<code>&gt;</code>、<code>&lt;</code>、<code>==</code>等符号进行关系判断，因此需要使用条件函数</p>
<table>
<thead>
<tr>
<th align="center">函数</th>
<th align="center">对应符号</th>
</tr>
</thead>
<tbody><tr>
<td align="center">eq</td>
<td align="center">==</td>
</tr>
<tr>
<td align="center">ne</td>
<td align="center">!=</td>
</tr>
<tr>
<td align="center">lt</td>
<td align="center">&lt;</td>
</tr>
<tr>
<td align="center">le</td>
<td align="center">&lt;=</td>
</tr>
<tr>
<td align="center">gt</td>
<td align="center">&gt;</td>
</tr>
<tr>
<td align="center">ge</td>
<td align="center">&gt;=</td>
</tr>
</tbody></table>
<p>使用示例</p>
<pre><code class="fenced-code-block language-html">{{if eq 5 .num}}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>num == 5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
{{else if lt 5 .num}}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>num &gt; 5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
{{else}}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>num &lt; 5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
{{end}}</code></pre>
<p>上述函数还有一些拓展用法，这里只简单介绍基础用法</p>
<br>

<p><strong>逻辑判断</strong></p>
<p>模板语言中可以用<code>and</code>、<code>or</code>、<code>not</code>进行逻辑运算</p>
<pre><code class="fenced-code-block language-html">{{if and (gt .num 0) (lt .num 5)}}    if num &gt; 0 &amp;&amp; num &lt; 5
{{if or (eq .num 0) (eq .num 5)}}    if num == 0 || num == 5
{{if not (eq .num 0)}}    if num != 0</code></pre>
<br>

<h2 class="atx" id="循环">循环</h2>
<p><code>range ... end</code></p>
<p><strong>循环切片</strong></p>
<p><code>controller/hello.go</code></p>
<pre><code class="fenced-code-block language-go">data <span class="token operator">:=</span> g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span>
    <span class="token string">"slice"</span><span class="token punctuation">:</span> g<span class="token punctuation">.</span>Array<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"张楚岚"</span><span class="token punctuation">,</span> <span class="token string">"诸葛青"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteTpl</span><span class="token punctuation">(</span><span class="token string">"hello/index.html"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span></code></pre>
<p><code>index.html</code></p>
<pre><code class="fenced-code-block language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zh<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/resource/css/bootstrap.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

   {{range .slice}}
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>{{.}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span> 
   {{end}}

   {{range $index, $value := .slice}}
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>index = {{$index}}, value = {{$value}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
   {{end}}


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<br>

<p><strong>map数据</strong></p>
<p><code>controller/hello.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Tpl</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data <span class="token operator">:=</span> g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span>
        <span class="token string">"mp"</span><span class="token punctuation">:</span> g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span>
            <span class="token string">"name"</span><span class="token punctuation">:</span>   <span class="token string">"冯宝宝"</span><span class="token punctuation">,</span>
            <span class="token string">"gender"</span><span class="token punctuation">:</span> <span class="token string">"女"</span><span class="token punctuation">,</span>
            <span class="token string">"age"</span><span class="token punctuation">:</span>    <span class="token number">100</span><span class="token punctuation">,</span>
            <span class="token string">"hobby"</span><span class="token punctuation">:</span>  <span class="token string">"埋人"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteTpl</span><span class="token punctuation">(</span><span class="token string">"hello/index.html"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<p><code>index.html</code></p>
<pre><code class="fenced-code-block language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zh<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/resource/css/bootstrap.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>姓名：{{.mp.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>性别：{{.mp.gender}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>年龄：{{.mp.age}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>爱好：{{.mp.hobby}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>


    {{range .mp}}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{.}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    {{end}}

    {{range $key, $value := .mp}}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{$key}}: {{$value}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    {{end}}

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<br>

<br>

<h1 class="atx" id="上传与下载">上传与下载</h1>
<h2 class="atx" id="文件上传">文件上传</h2>
<p>文件上传可以通过表单上传，也可以通过Ajax上传，GoFrame框架后端处理都是一样的，所以只演示一下表单上传。</p>
<p><strong>单文件上传</strong></p>
<p><code>html/upload.html</code></p>
<pre><code class="fenced-code-block language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>上传文件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/upload<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ufile<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ufiles<span class="token punctuation">"</span></span> <span class="token attr-name">multiple</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>上传<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><code>controller/hello.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Upload</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    file <span class="token operator">:=</span> req<span class="token punctuation">.</span><span class="token function">GetUploadFile</span><span class="token punctuation">(</span><span class="token string">"ufile"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> file <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        file<span class="token punctuation">.</span>Filename <span class="token operator">=</span> <span class="token string">"20231001.png"</span> <span class="token comment">// 可以根据需要给文件重命名</span>
        name<span class="token punctuation">,</span> err <span class="token operator">:=</span> file<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token string">"./upload"</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>多文件上传</strong></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Upload</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    files <span class="token operator">:=</span> req<span class="token punctuation">.</span><span class="token function">GetUploadFiles</span><span class="token punctuation">(</span><span class="token string">"ufiles"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> files <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        names<span class="token punctuation">,</span> err <span class="token operator">:=</span> files<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token string">"./upload"</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>除了从请求中获取上传文件以外，如果用api规范路由，还可以用如下方式获取上传文件</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> UploadReq <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta <span class="token string">`path:"/upload" method:"post"`</span>

    Ufile ghttp<span class="token punctuation">.</span>UploadFile <span class="token string">`json:"ufile"`</span>

    UFiles ghttp<span class="token punctuation">.</span>UploadFiles <span class="token string">`json:"ufiles"`</span>
<span class="token punctuation">}</span></code></pre>
<p>使用这种方式，如果文件允许为空， 则可能会发生转换错误。</p>
<br>

<p><strong>文件上传应用实例</strong></p>
<ul>
<li>在静态资源目录新建<code>upload</code>文件夹用于存放上传文件，示例中为<code>resource/public/upload</code>，绑定的静态目录为<code>resource/public</code>，因此可以用<code>/upload/&lt;filename&gt;</code>的形式访问指定文件</li>
<li>将上传文件名称修改为对应文件的哈希值，以防上传同名文件覆盖</li>
<li>返回文件的URL</li>
</ul>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Upload</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> r <span class="token operator">*</span>api<span class="token punctuation">.</span>UploadReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>api<span class="token punctuation">.</span>UploadRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    req <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">RequestFromCtx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
    file <span class="token operator">:=</span> req<span class="token punctuation">.</span><span class="token function">GetUploadFile</span><span class="token punctuation">(</span><span class="token string">"ufile"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> file <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> md5str <span class="token builtin">string</span>
        md5str<span class="token punctuation">,</span> err <span class="token operator">=</span> gmd5<span class="token punctuation">.</span><span class="token function">Encrypt</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
        file<span class="token punctuation">.</span>Filename <span class="token operator">=</span> md5str <span class="token operator">+</span> path<span class="token punctuation">.</span><span class="token function">Ext</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>Filename<span class="token punctuation">)</span>
        name<span class="token punctuation">,</span> err <span class="token operator">:=</span> file<span class="token punctuation">.</span><span class="token function">Save</span><span class="token punctuation">(</span><span class="token string">"resource/public/upload"</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            res <span class="token operator">=</span> <span class="token operator">&amp;</span>api<span class="token punctuation">.</span>UploadRes<span class="token punctuation">{</span>
                Data<span class="token punctuation">:</span> <span class="token string">"/upload/"</span> <span class="token operator">+</span> name<span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span></code></pre>
<br>

<h2 class="atx" id="文件下载">文件下载</h2>
<p><strong>ServeFile</strong></p>
<p><code>ServeFile</code>向客户端返回一个文件内容，如果是文本或者图片，将会直接展示，不能直接在浏览器中展示的将进行下载</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Download</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">ServeFile</span><span class="token punctuation">(</span><span class="token string">"upload/1.png"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>ServeFileDownload</strong></p>
<p>该方法直接引导客户端进行下载，并且可以给下载文件重命名</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Download</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">ServeFileDownload</span><span class="token punctuation">(</span><span class="token string">"upload/1.png"</span><span class="token punctuation">,</span> <span class="token string">"download.png"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<br>

<h2 class="atx" id="上传限制">上传限制</h2>
<p>如果需要限制单次上传文件大小，可以用<code>clientMaxBodySize</code>配置。如果完全不需要限制，直接设为0即可</p>
<p><code>config.yaml</code></p>
<pre><code class="fenced-code-block language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">clientMaxBodySize</span><span class="token punctuation">:</span> <span class="token string">"0"</span></code></pre>
<br>

<h1 class="atx" id="数据校验">数据校验</h1>
<p>在使用中，经常需要验证前端提交过来的数据是否符合规则，比如非空、长度限制、是否为数字等一系列验证。在GoFrame中，基本上都不用手动写验证规则，框架里已经提供了很多内置的验证规则可以用来验证数据。验证规则详细内容见官方文档<a href="">数据校验/校验规则</a></p>
<br>

<p><strong>单个规则/错误提示信息</strong></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Valid</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> rq <span class="token operator">*</span>api<span class="token punctuation">.</span>ValidReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>rs <span class="token operator">*</span>api<span class="token punctuation">.</span>ValidRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> Data <span class="token keyword">struct</span> <span class="token punctuation">{</span>
        Name  g<span class="token punctuation">.</span>Map <span class="token string">`v:"required#name不能为空"`</span>
        Age   <span class="token builtin">int</span>    <span class="token string">`v:"required"`</span>
        Phone <span class="token builtin">string</span> <span class="token string">`v:"required"`</span>
    <span class="token punctuation">}</span>

    data <span class="token operator">:=</span> Data<span class="token punctuation">{</span><span class="token punctuation">}</span>
    err <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">Validator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Bail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>

    rs <span class="token operator">=</span> <span class="token operator">&amp;</span>api<span class="token punctuation">.</span>ValidRes<span class="token punctuation">{</span>Data<span class="token punctuation">:</span> data<span class="token punctuation">}</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>多个规则</strong></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Valid</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> rq <span class="token operator">*</span>api<span class="token punctuation">.</span>ValidReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>rs <span class="token operator">*</span>api<span class="token punctuation">.</span>ValidRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> Data <span class="token keyword">struct</span> <span class="token punctuation">{</span>
        Name  <span class="token builtin">string</span>
        Age   <span class="token builtin">string</span> <span class="token string">`v:"required|integer|min:1#age不能为空|age必须为整数|age不能小于1"`</span>
        Phone <span class="token builtin">string</span>
    <span class="token punctuation">}</span>

    data <span class="token operator">:=</span> Data<span class="token punctuation">{</span>Age<span class="token punctuation">:</span> <span class="token string">"1.1"</span><span class="token punctuation">}</span>
    err <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">Validator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Bail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>

    rs <span class="token operator">=</span> <span class="token operator">&amp;</span>api<span class="token punctuation">.</span>ValidRes<span class="token punctuation">{</span>Data<span class="token punctuation">:</span> data<span class="token punctuation">}</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>使用Map指定校验规则</strong></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Valid</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> rq <span class="token operator">*</span>api<span class="token punctuation">.</span>ValidReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>rs <span class="token operator">*</span>api<span class="token punctuation">.</span>ValidRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> Data <span class="token keyword">struct</span> <span class="token punctuation">{</span>
        Name  <span class="token builtin">string</span>
        Age   <span class="token builtin">int</span>
        Phone <span class="token builtin">string</span>
    <span class="token punctuation">}</span>

    rules <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
        <span class="token string">"Name"</span><span class="token punctuation">:</span>  <span class="token string">"required|length:6,16"</span><span class="token punctuation">,</span>
        <span class="token string">"Age"</span><span class="token punctuation">:</span>   <span class="token string">"between:18,30"</span><span class="token punctuation">,</span>
        <span class="token string">"Phone"</span><span class="token punctuation">:</span> <span class="token string">"phone"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    message <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span>
        <span class="token string">"Name"</span><span class="token punctuation">:</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
            <span class="token string">"required"</span><span class="token punctuation">:</span> <span class="token string">"Name不能为空"</span><span class="token punctuation">,</span>
            <span class="token string">"length"</span><span class="token punctuation">:</span>   <span class="token string">"长度只能为{min}到{max}个字符"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">"Age"</span><span class="token punctuation">:</span> <span class="token string">"年龄只能为18到30岁"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    data <span class="token operator">:=</span> Data<span class="token punctuation">{</span>Phone<span class="token punctuation">:</span> <span class="token string">"123"</span><span class="token punctuation">}</span>
    err <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">Validator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Rules</span><span class="token punctuation">(</span>rules<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Messages</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>

    rs <span class="token operator">=</span> <span class="token operator">&amp;</span>api<span class="token punctuation">.</span>ValidRes<span class="token punctuation">{</span>Data<span class="token punctuation">:</span> data<span class="token punctuation">}</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>规范路由API数据校验</strong></p>
<p>如果输入数据直接在API里定义了结构，可直接将校验规则写上，在请求时会自动校验，不需要再手动调用校验函数。</p>
<p><code>api/hello.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> ValidReq <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta <span class="token string">`path:"/valid" method:"all"`</span>

    Name  <span class="token builtin">string</span> <span class="token string">`v:"required|length:6,16"`</span>
    Age   <span class="token builtin">int</span>    <span class="token string">`v:"required"`</span>
    Phone <span class="token builtin">string</span> <span class="token string">`v:"phone"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> ValidRes <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Data <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token string">`json:"data"`</span>
<span class="token punctuation">}</span></code></pre>
<p><code>controller/hello.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Valid</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> rq <span class="token operator">*</span>api<span class="token punctuation">.</span>ValidReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>rs <span class="token operator">*</span>api<span class="token punctuation">.</span>ValidRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span></code></pre>
<br>

<h1 class="atx" id="cookiesession">Cookie/Session</h1>
<p>Cookie是保存在浏览器的一些数据，在请求的时候会放在请求头当中一同发送，通常用来保存sessionid、token等一些数据。</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Cookie</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    req<span class="token punctuation">.</span>Cookie<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"kslfjojklcjkldjfsie"</span><span class="token punctuation">)</span>
    req<span class="token punctuation">.</span>Cookie<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"user_name"</span><span class="token punctuation">,</span> <span class="token string">"诸葛青"</span><span class="token punctuation">)</span>

    name <span class="token operator">:=</span> req<span class="token punctuation">.</span>Cookie<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"user_name"</span><span class="token punctuation">)</span>
    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"name from cookie: "</span> <span class="token operator">+</span> name<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    req<span class="token punctuation">.</span>Cookie<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<p>Session机制用于判断请求由哪一用户发起，Session数据保存在服务器。</p>
<p>以前常用于保存登录数据，进行登录验证，不过现在只是有些比较小的，前后端不分离的项目还在使用。   </p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Session</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    op <span class="token operator">:=</span> req<span class="token punctuation">.</span><span class="token function">GetQuery</span><span class="token punctuation">(</span><span class="token string">"op"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> op <span class="token operator">==</span> <span class="token string">"set"</span> <span class="token punctuation">{</span>
        req<span class="token punctuation">.</span>Session<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> g<span class="token punctuation">.</span>Map<span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> op <span class="token operator">==</span> <span class="token string">"get"</span> <span class="token punctuation">{</span>
        req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>Session<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> op <span class="token operator">==</span> <span class="token string">"rm"</span> <span class="token punctuation">{</span>
        req<span class="token punctuation">.</span>Session<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<br>

<h1 class="atx" id="golang-jwt">golang-jwt</h1>
<p>前后端分离的项目更常用的登录验证是<code>JWT(JSON web token)</code>。GoFrame中没有提供相关生成与验证，需要添加第三方库，例如<code>golang-jwt</code></p>
<p>简单使用方式如下：</p>
<ul>
<li>添加</li>
</ul>
<pre><code class="fenced-code-block language-shell">go get -u github.com/golang-jwt/jwt/v5</code></pre>
<ul>
<li>导入</li>
</ul>
<pre><code class="fenced-code-block language-go"><span class="token keyword">import</span> <span class="token string">"github.com/golang-jwt/jwt/v5"</span></code></pre>
<ul>
<li>生成token</li>
</ul>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Jwt</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> UserClaims <span class="token keyword">struct</span> <span class="token punctuation">{</span>
        UserID   <span class="token builtin">uint</span>
        UserName <span class="token builtin">string</span>
        jwt<span class="token punctuation">.</span>RegisteredClaims
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> key <span class="token operator">=</span> <span class="token string">"arandomstring"</span>

    claim <span class="token operator">:=</span> UserClaims<span class="token punctuation">{</span>
        UserID<span class="token punctuation">:</span>   <span class="token number">1011</span><span class="token punctuation">,</span>
        UserName<span class="token punctuation">:</span> <span class="token string">"张之维"</span><span class="token punctuation">,</span>
        RegisteredClaims<span class="token punctuation">:</span> jwt<span class="token punctuation">.</span>RegisteredClaims<span class="token punctuation">{</span>
            Subject<span class="token punctuation">:</span>   <span class="token string">"张之维"</span><span class="token punctuation">,</span>
            ExpiresAt<span class="token punctuation">:</span> jwt<span class="token punctuation">.</span><span class="token function">NewNumericDate</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Minute <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    token<span class="token punctuation">,</span> err <span class="token operator">:=</span> jwt<span class="token punctuation">.</span><span class="token function">NewWithClaims</span><span class="token punctuation">(</span>jwt<span class="token punctuation">.</span>SigningMethodHS256<span class="token punctuation">,</span> claim<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SignedString</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<ul>
<li>token验证</li>
</ul>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>Controller<span class="token punctuation">)</span> <span class="token function">Jwt</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> UserClaims <span class="token keyword">struct</span> <span class="token punctuation">{</span>
        UserID   <span class="token builtin">uint</span>
        UserName <span class="token builtin">string</span>
        jwt<span class="token punctuation">.</span>RegisteredClaims
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> key <span class="token operator">=</span> <span class="token string">"arandomstring"</span>

    token <span class="token operator">:=</span> <span class="token string">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjEwMTEsIlVzZXJOYW1lIjoi5byg5LmL57u0Iiwic3ViIjoi5byg5LmL57u0IiwiZXhwIjoxNjk4NjcxMjA3fQ.r11R1_WcDueBU52BoUjDS94jqemgrhU-V4WW7YSvXWE"</span>
    result<span class="token punctuation">,</span> err <span class="token operator">:=</span> jwt<span class="token punctuation">.</span><span class="token function">ParseWithClaims</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> <span class="token operator">&amp;</span>UserClaims<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>t <span class="token operator">*</span>jwt<span class="token punctuation">.</span>Token<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token operator">&amp;&amp;</span> result<span class="token punctuation">.</span>Valid <span class="token punctuation">{</span>
        claim<span class="token punctuation">,</span> ok <span class="token operator">:=</span> result<span class="token punctuation">.</span>Claims<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>UserClaims<span class="token punctuation">)</span>
        <span class="token keyword">if</span> ok <span class="token punctuation">{</span>
            req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span><span class="token string">"token验证成功"</span><span class="token punctuation">)</span>
            req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>claim<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>Claims<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><code>jwt.RegisteredClaims</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">type</span> RegisteredClaims <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">// 发布者</span>
    Issuer <span class="token builtin">string</span> <span class="token string">`json:"iss,omitempty"`</span>

    <span class="token comment">// token使用主体</span>
    Subject <span class="token builtin">string</span> <span class="token string">`json:"sub,omitempty"`</span>

    <span class="token comment">// </span>
    Audience ClaimStrings <span class="token string">`json:"aud,omitempty"`</span>

    <span class="token comment">// 失效时间</span>
    ExpiresAt <span class="token operator">*</span>NumericDate <span class="token string">`json:"exp,omitempty"`</span>

    <span class="token comment">// 生效时间</span>
    NotBefore <span class="token operator">*</span>NumericDate <span class="token string">`json:"nbf,omitempty"`</span>

    <span class="token comment">// 发布时间</span>
    IssuedAt <span class="token operator">*</span>NumericDate <span class="token string">`json:"iat,omitempty"`</span>

    <span class="token comment">// 可以唯一标识这一jwt的字符串，用来防止数据相似的jwt哈希碰撞</span>
    ID <span class="token builtin">string</span> <span class="token string">`json:"jti,omitempty"`</span>
<span class="token punctuation">}</span></code></pre>
<br>

<h1 class="atx" id="中间件">中间件</h1>
<p>中间件（拦截器）是在请求与响应的过程中，拦截下请求与响应并做一些操作，常见的用途是在请求前进行鉴权，在请求后对响应数据进行包装等</p>
<p>中间件的定义与普通路由函数一样，只是其中需要用<code>Next()</code>进行路由放行。</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token function">MiddleWare</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span>Middleware<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<p><strong>前置中间件</strong></p>
<p>在执行具体的路由函数之前进行操作的中间件称为前置中间件，例如进行登录验证的中间件：</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>sMiddleware<span class="token punctuation">)</span> <span class="token function">Auth</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    user <span class="token operator">:=</span> service<span class="token punctuation">.</span><span class="token function">Session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetUser</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span><span class="token function">Context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> user<span class="token punctuation">.</span>Id <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        <span class="token boolean">_</span> <span class="token operator">=</span> service<span class="token punctuation">.</span><span class="token function">Session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetNotice</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span><span class="token function">Context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>model<span class="token punctuation">.</span>SessionNotice<span class="token punctuation">{</span>
            Type<span class="token punctuation">:</span>    consts<span class="token punctuation">.</span>SessionNoticeTypeWarn<span class="token punctuation">,</span>
            Content<span class="token punctuation">:</span> <span class="token string">"未登录或会话已过期，请您登录后再继续"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token comment">// 只有GET请求才支持保存当前URL，以便后续登录后再跳转回来。</span>
        <span class="token keyword">if</span> r<span class="token punctuation">.</span>Method <span class="token operator">==</span> <span class="token string">"GET"</span> <span class="token punctuation">{</span>
            <span class="token boolean">_</span> <span class="token operator">=</span> service<span class="token punctuation">.</span><span class="token function">Session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetLoginReferer</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span><span class="token function">Context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span><span class="token function">GetUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 根据当前请求方式执行不同的返回数据结构</span>
        <span class="token keyword">if</span> r<span class="token punctuation">.</span><span class="token function">IsAjaxRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            response<span class="token punctuation">.</span><span class="token function">JsonRedirectExit</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>LoginUrl<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">RedirectTo</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>LoginUrl<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    r<span class="token punctuation">.</span>Middleware<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>后置中间件</strong></p>
<p>在路由函数执行完成之后再进行操作的中间件称为后置中间件，例如对返回的数据格式进行统一封装的中间件：</p>
<pre><code class="fenced-code-block language-go"><span class="token comment">// 返回处理中间件</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>sMiddleware<span class="token punctuation">)</span> <span class="token function">ResponseHandler</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span>Middleware<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// 如果已经有返回内容，那么该中间件什么也不做</span>
    <span class="token keyword">if</span> r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">BufferLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">var</span> <span class="token punctuation">(</span>
        err             <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">GetError</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        res             <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">GetHandlerResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        code gcode<span class="token punctuation">.</span>Code <span class="token operator">=</span> gcode<span class="token punctuation">.</span>CodeOK
    <span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        code <span class="token operator">=</span> gerror<span class="token punctuation">.</span><span class="token function">Code</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">if</span> code <span class="token operator">==</span> gcode<span class="token punctuation">.</span>CodeNil <span class="token punctuation">{</span>
            code <span class="token operator">=</span> gcode<span class="token punctuation">.</span>CodeInternalError
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> r<span class="token punctuation">.</span><span class="token function">IsAjaxRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            response<span class="token punctuation">.</span><span class="token function">JsonExit</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> code<span class="token punctuation">.</span><span class="token function">Code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            service<span class="token punctuation">.</span><span class="token function">View</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Render500</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span><span class="token function">Context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> model<span class="token punctuation">.</span>View<span class="token punctuation">{</span>
                Error<span class="token punctuation">:</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> r<span class="token punctuation">.</span><span class="token function">IsAjaxRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            response<span class="token punctuation">.</span><span class="token function">JsonExit</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> code<span class="token punctuation">.</span><span class="token function">Code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// 什么都不做，业务API自行处理模板渲染的成功逻辑。</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>中件间的定义实际上就是如下：</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token function">MiddleWare</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 前置中间件</span>
    r<span class="token punctuation">.</span>Middleware<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 后置中间件</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>SetCtxVar/GetCtxVar</strong></p>
<p>如果需要在一些请求流程中进行参数传递，可以用<code>SetCtxVar/GetCtxVar</code>进行存取</p>
<p>例如</p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">func</span> <span class="token function">MiddleWare</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r<span class="token punctuation">.</span><span class="token function">SetCtxVar</span><span class="token punctuation">(</span><span class="token string">"UserName"</span><span class="token punctuation">,</span> <span class="token string">"陆玲珑"</span><span class="token punctuation">)</span>
    r<span class="token punctuation">.</span>Middleware<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<p>在具体路由函数中取用</p>
<pre><code class="fenced-code-block language-go">UserName <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">GetCtxVar</span><span class="token punctuation">(</span><span class="token string">"UserName"</span><span class="token punctuation">)</span></code></pre>
<br>

<h1 class="atx" id="组件">组件</h1>
<h2 class="atx" id="数据结构">数据结构</h2>
<p>GoFrame中提供了一些常用的数据结构，如列表、队列、集合、Map等，详细内容见官方文档。</p>
<br>

<h2 class="atx" id="时间">时间</h2>
<p><strong>当前时间</strong></p>
<pre><code class="fenced-code-block language-go">t <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<pre><code class="fenced-code-block language-go">t <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<pre><code class="fenced-code-block language-go">t <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">Datetime</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p><strong>创建时间对象</strong></p>
<pre><code class="fenced-code-block language-go">t <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"2023-11-03 21:45:22"</span><span class="token punctuation">)</span></code></pre>
<p>参数可以是字符串、时间戳、时间对象等数据</p>
<pre><code class="fenced-code-block language-go">t <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">NewFromStr</span><span class="token punctuation">(</span><span class="token string">"2023-11-03 21:50:25"</span><span class="token punctuation">)</span></code></pre>
<pre><code class="fenced-code-block language-go">t<span class="token punctuation">,</span> err <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">StrToTime</span><span class="token punctuation">(</span><span class="token string">"2023-11-03 21:50:25"</span><span class="token punctuation">)</span></code></pre>
<p>将字符串转为时间对象，具体支持的时间格式见文档<a href="">时间管理/工具方法</a></p>
<p><strong>设置时区</strong></p>
<pre><code class="fenced-code-block language-go">gtime<span class="token punctuation">.</span><span class="token function">SetTimeZone</span><span class="token punctuation">(</span><span class="token string">"Asia/Tokyo"</span><span class="token punctuation">)</span>
t <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p><strong>时间戳</strong></p>
<pre><code class="fenced-code-block language-go">t1 <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
t2 <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">TimestampMilli</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
t3 <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">TimestampMicro</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
t4 <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">TimestampNano</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>返回为<code>int64</code>类型，也可以返回字符串类型</p>
<pre><code class="fenced-code-block language-go">t1 <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">TimestampStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
t2 <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">TimestampMilliStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
t3 <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">TimestampMicroStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
t4 <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">TimestampNanoStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p><strong>格式化日期数据</strong></p>
<p>可以将日期格式化为指定的格式，具体格式化用到的符号见文档<a href="">时间管理/时间格式</a></p>
<pre><code class="fenced-code-block language-go">t <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"Y-m-d H:i:s"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"YmdHis"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p><strong>获取年月日时分秒</strong></p>
<pre><code class="fenced-code-block language-go">t <span class="token operator">:=</span> gtime<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">Year</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">Month</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">Day</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">Hour</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">Minute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">Writeln</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">Second</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>更多操作方法见文档<a href="">时间管理/方法介绍</a></p>
<br>

<h2 class="atx" id="随机数">随机数</h2>
<p><strong>随机整数</strong></p>
<pre><code class="fenced-code-block language-go">n <span class="token operator">:=</span> grand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span></code></pre>
<p>返回0 &lt;= n &lt; 100的随机数</p>
<pre><code class="fenced-code-block language-go">n <span class="token operator">:=</span> grand<span class="token punctuation">.</span><span class="token function">N</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">999</span><span class="token punctuation">)</span></code></pre>
<p>返回100 &lt;= n &lt;= 999的随机数</p>
<br>

<p><strong>随机字符串</strong></p>
<pre><code class="fenced-code-block language-go">s <span class="token operator">:=</span> grand<span class="token punctuation">.</span><span class="token function">S</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
s <span class="token operator">:=</span> grand<span class="token punctuation">.</span><span class="token function">S</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span></code></pre>
<p>返回指定长度的随机字母/数字组合的字符串，第二个参数为<code>true</code>表示包括特殊符号</p>
<pre><code class="fenced-code-block language-go">s <span class="token operator">:=</span> grand<span class="token punctuation">.</span><span class="token function">Digits</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span></code></pre>
<p>返回指定长度的随机数字字符串</p>
<pre><code class="fenced-code-block language-go">s <span class="token operator">:=</span> grand<span class="token punctuation">.</span><span class="token function">Letters</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span></code></pre>
<p>返回指定长度的随机字母字符串</p>
<pre><code class="fenced-code-block language-go">s <span class="token operator">:=</span> grand<span class="token punctuation">.</span><span class="token function">Symbols</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span></code></pre>
<p>返回指定长度的随机特殊符号字符串</p>
<pre><code class="fenced-code-block language-go">s <span class="token operator">:=</span> grand<span class="token punctuation">.</span><span class="token function">Str</span><span class="token punctuation">(</span><span class="token string">"日照香炉生紫烟，遥看瀑布挂前川。Oh Yeah"</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span></code></pre>
<p>从给定的字符串中随机返回指定数量的字符，可以是汉字。</p>
<br>

<p><strong>全局唯一数</strong></p>
<pre><code class="fenced-code-block language-go">s <span class="token operator">:=</span> guid<span class="token punctuation">.</span><span class="token function">S</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<br>

<br>

<h1 class="atx" id="接口文档">接口文档</h1>
<p>用规范路由的写法，GoFrame会自动生成接口文档。所有接口信息会自动生成在<code>/api.json</code>中，遵循的是<code>OpenAPIv3</code>标准，框架默认使用的是<code>redoc</code>来生成文档前端页面，只能查看接口信息，不能进行请求测试。因此可以可以改为其他UI页面，例如<code>swaggerUI</code>或者自行实现UI页面。</p>
<ul>
<li><strong>注释掉<code>manifest/config/config.yml</code>中的<code>swaggerPath: "/swagger"</code></strong></li>
<li><strong>实现UI页面，引入<code>swaggerUI</code>组件</strong></li>
</ul>
<p><code>swagger.html</code></p>
<pre><code class="fenced-code-block language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>IE=edge<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/swagger-ui.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/swagger-ui-bundle.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>API Doc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swagger-ui<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    window<span class="token punctuation">.</span>ui <span class="token operator">=</span> <span class="token function">SwaggerUIBundle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/api.json'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">dom_id</span><span class="token operator">:</span> <span class="token string">'#swagger-ui'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>引入的CSS与JS文件如果下载到项目中则用上述方式引入，或者可以通过下列CDN引入</p>
<pre><code class="fenced-code-block language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/swagger-ui-dist@latest/swagger-ui.css<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre>
<ul>
<li><strong>添加路由</strong></li>
</ul>
<pre><code class="fenced-code-block language-go">group<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/swagger"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteTpl</span><span class="token punctuation">(</span><span class="token string">"/swagger.html"</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<br>

<h1 class="atx" id="构建打包">构建打包</h1>
<p>GoFrame中静态资源也可以直接打包进可执行文件当中，发布时只需提供一个可执行文件即可。</p>
<ul>
<li><strong>配置</strong></li>
</ul>
<p><code>hack/config.yaml</code></p>
<pre><code class="fenced-code-block language-yaml"><span class="token key atrule">gfcli</span><span class="token punctuation">:</span>
  <span class="token key atrule">build</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">"hellogf"</span>
    <span class="token key atrule">arch</span><span class="token punctuation">:</span> <span class="token string">"amd64"</span>
    <span class="token key atrule">system</span><span class="token punctuation">:</span> <span class="token string">"linux"</span>
    <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token string">"none"</span>
    <span class="token key atrule">cgo</span><span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token key atrule">packSrc</span><span class="token punctuation">:</span> <span class="token string">"manifest/config,resource/public,resource/template"</span>
    <span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">"1.0.0"</span>
    <span class="token key atrule">output</span><span class="token punctuation">:</span> <span class="token string">"./bin"</span>
    <span class="token key atrule">extra</span><span class="token punctuation">:</span> <span class="token string">""</span></code></pre>
<blockquote>
<ul>
<li><code>name</code>：打包后的可执行文件名</li>
<li><code>arch</code>：系统架构，可以有多个，用<kbd>,</kbd>分隔，用<code>all</code>表示编译所有支持的架构</li>
<li><code>system</code>：编译平台，可以有多个，用<kbd>,</kbd>分隔，用<code>all</code>表示编译所有支持的系统</li>
<li><code>packSrc</code>：需要打包的静态资源目录</li>
<li><code>version</code>：版本号</li>
</ul>
</blockquote>
<ul>
<li><strong>打包</strong></li>
</ul>
<pre><code class="fenced-code-block language-shell">gf build</code></pre>
<p>以上操作会把指定的目录一起打包进可执行文件。通常情况例如配置文件等一些需要改动的文件不用打包进可执行文件。</p>
<br>

<h1 class="atx" id="综合示例">综合示例</h1>
<p>本示例简单实现下列功能的API：</p>
<ol>
<li>书本数据获取(分页)</li>
<li>书本数据添加、编辑、删除</li>
<li>用户名与密码登录</li>
<li>书本数据展示与添加、编辑、删除需要登录才能访问</li>
</ol>
<p>本示例用API实现，即只用JSON格式数据进行返回。如果需要用模板实现，核心部分都相同，只是需要将返回的数据自行组织到模板页面上。</p>
<h2 class="atx" id=""></h2>
<p><strong>1. 创建项目</strong></p>
<pre><code class="fenced-code-block language-shell">gf init gfbook</code></pre>
<p>删除<code>api</code>、<code>controller</code>中自动生成的文件，删除<code>cmd.go</code>中的路由绑定。</p>
<p>添加依赖的库，<code>mysql</code>驱动和<code>jwt</code></p>
<p>方法一（需要联网）：</p>
<pre><code class="fenced-code-block language-shell">go get github.com/gogf/gf/contrib/drivers/mysql/v2
go get github.com/golang-jwt/jwt/v5</code></pre>
<p><code>mysql</code>驱动初始化导入</p>
<p><code>main.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token boolean">_</span> <span class="token string">"github.com/gogf/gf/contrib/drivers/mysql/v2"</span>
<span class="token punctuation">)</span></code></pre>
<p>方法二（需要之前已经下载过对应版本的库，此次不需要联网）</p>
<p>需要先进行初始化导入，不然没法添加</p>
<p><code>main.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token boolean">_</span> <span class="token string">"github.com/gogf/gf/contrib/drivers/mysql/v2"</span>
    <span class="token boolean">_</span> <span class="token string">"github.com/golang-jwt/jwt/v5"</span> <span class="token comment">// 这行在go mod tidy运行之后删除</span>
<span class="token punctuation">)</span></code></pre>
<p><code>go.mod</code></p>
<pre><code class="fenced-code-block language-go">require <span class="token punctuation">(</span>
    github<span class="token punctuation">.</span>com<span class="token operator">/</span>gogf<span class="token operator">/</span>gf<span class="token operator">/</span>contrib<span class="token operator">/</span>drivers<span class="token operator">/</span>mysql<span class="token operator">/</span>v2 v2<span class="token punctuation">.</span><span class="token number">5.3</span>
    github<span class="token punctuation">.</span>com<span class="token operator">/</span>gogf<span class="token operator">/</span>gf<span class="token operator">/</span>v2 v2<span class="token punctuation">.</span><span class="token number">5.3</span>
    github<span class="token punctuation">.</span>com<span class="token operator">/</span>golang<span class="token operator">-</span>jwt<span class="token operator">/</span>jwt<span class="token operator">/</span>v5 v5<span class="token punctuation">.</span><span class="token number">0.0</span>
<span class="token punctuation">)</span></code></pre>
<p>执行以下指令更新</p>
<pre><code class="fenced-code-block language-shell">go mod tidy</code></pre>
<p><strong>2. 配置</strong></p>
<p><code>internal/config/config.yaml</code></p>
<p>配置数据库连接</p>
<pre><code class="fenced-code-block language-yaml"><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">address</span><span class="token punctuation">:</span>     <span class="token string">":8000"</span>
  <span class="token key atrule">openapiPath</span><span class="token punctuation">:</span> <span class="token string">"/api.json"</span>
  <span class="token key atrule">swaggerPath</span><span class="token punctuation">:</span> <span class="token string">"/swagger"</span>
  <span class="token key atrule">serverRoot</span><span class="token punctuation">:</span>  <span class="token string">"resource/public/resource"</span>

<span class="token key atrule">database</span><span class="token punctuation">:</span>
  <span class="token key atrule">link</span><span class="token punctuation">:</span> <span class="token string">"mysql:root:root@tcp(127.0.0.1:3306)/goframe?loc=Local&amp;parseTime=true"</span>

<span class="token key atrule">logger</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span> <span class="token punctuation">:</span> <span class="token string">"all"</span>
  <span class="token key atrule">stdout</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></code></pre>
<p>准备需要用到的资源文件</p>
<p><code>hack/config.yaml</code></p>
<p>配置DAO生成相关信息</p>
<pre><code class="fenced-code-block language-yaml"><span class="token key atrule">gfcli</span><span class="token punctuation">:</span>
  <span class="token key atrule">gen</span><span class="token punctuation">:</span>
    <span class="token key atrule">dao</span><span class="token punctuation">:</span>
      <span class="token key atrule">link</span><span class="token punctuation">:</span> <span class="token string">"mysql:root:root@tcp(127.0.0.1:3306)/goframe"</span>
      <span class="token key atrule">tables</span><span class="token punctuation">:</span> <span class="token string">"user,book"</span>
      <span class="token key atrule">jsonCase</span><span class="token punctuation">:</span> <span class="token string">"Snake"</span></code></pre>
<p>配置完成之后运行命令生成DAO相关文件</p>
<pre><code class="fenced-code-block language-shell">gf gen dao</code></pre>
<p><strong>3.编写API数据结构</strong></p>
<p><code>api/user/user.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> user

<span class="token keyword">import</span> <span class="token string">"github.com/gogf/gf/v2/frame/g"</span>

<span class="token keyword">type</span> LoginReq <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta   <span class="token string">`path:"/login" method:"post"`</span>
    Username <span class="token builtin">string</span> <span class="token string">`p:"username" v:"required#请输入用户名" dc:"用户名"`</span>
    Password <span class="token builtin">string</span> <span class="token string">`p:"password" v:"required#请输入密码" dc:"密码"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> UserInfo <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Id       <span class="token builtin">uint</span>   <span class="token string">`json:"id"         dc:"用户ID"`</span>
    Username <span class="token builtin">string</span> <span class="token string">`json:"username"   dc:"用户名"`</span>
    Nickname <span class="token builtin">string</span> <span class="token string">`json:"nickname"   dc:"昵称"`</span>
    Avatar   <span class="token builtin">string</span> <span class="token string">`json:"avatar"     dc:"用户头像"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> LoginRes <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Token    <span class="token builtin">string</span>    <span class="token string">`json:"token" dc:"验证token"`</span>
    UserInfo <span class="token operator">*</span>UserInfo <span class="token string">`json:"user_info"`</span>
<span class="token punctuation">}</span></code></pre>
<p><code>api/book/book.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> book

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"gfbook/internal/model/entity"</span>

    <span class="token string">"github.com/gogf/gf/v2/frame/g"</span>
    <span class="token string">"github.com/gogf/gf/v2/os/gtime"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> IndexReq <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta   <span class="token string">`path:"/book" method:"get"`</span>
    Page     <span class="token builtin">uint</span> <span class="token string">`p:"page" v:"required|integer|min:1#数据页不能为空|数据页只能是整数|数据页不能小于1" dc:"页数"`</span>
    PageSize <span class="token builtin">uint</span> <span class="token string">`p:"page_size" v:"integer|min:1#数据大小只能为整数|数据大小不能小于1" d:"10" dc:"每页数据量"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> IndexRes <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Page     <span class="token builtin">uint</span>          <span class="token string">`json:"page" dc:"页数"`</span>
    PageSize <span class="token builtin">uint</span>          <span class="token string">`json:"page_size" dc:"每页数据量"`</span>
    Rows     <span class="token punctuation">[</span><span class="token punctuation">]</span>entity<span class="token punctuation">.</span>Book <span class="token string">`json:"rows" dc:"查询数据"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> AddReq <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta      <span class="token string">`path:"/book" method:"post"`</span>
    Name        <span class="token builtin">string</span>      <span class="token string">`p:"name" v:"required#书名不能为空"  dc:"书名"      `</span>
    Author      <span class="token builtin">string</span>      <span class="token string">`p:"author" v:"required#作者不能为空"   dc:"作者"     `</span>
    Price       <span class="token builtin">float64</span>     <span class="token string">`p:"price" v:"required|float|min:0#价格不能为空|价格格式不正确|价格不能小于0" dc:"价格"       `</span>
    PublishTime <span class="token operator">*</span>gtime<span class="token punctuation">.</span>Time <span class="token string">`p:"publish_time" v:"date#出版时间格式不正确" dc:"出版日期"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> AddRes <span class="token keyword">struct</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> EditReq <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta      <span class="token string">`path:"/book" method:"put"`</span>
    Id          <span class="token builtin">uint</span>        <span class="token string">`p:"id" v:"required" dc:"书本ID"`</span>
    Name        <span class="token builtin">string</span>      <span class="token string">`p:"name"  dc:"书名"      `</span>
    Author      <span class="token builtin">string</span>      <span class="token string">`p:"author"   dc:"作者"     `</span>
    Price       <span class="token builtin">float64</span>     <span class="token string">`p:"price" v:"float|min:0#价格格式不正确|价格不能小于0"  dc:"价格"      `</span>
    PublishTime <span class="token operator">*</span>gtime<span class="token punctuation">.</span>Time <span class="token string">`p:"publish_time" v:"date#出版时间格式不正确" dc:"出版日期"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> EditRes <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">type</span> DelReq <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    g<span class="token punctuation">.</span>Meta <span class="token string">`path:"/book" method:"delete"`</span>
    Id     <span class="token builtin">uint</span> <span class="token string">`p:"id" v:"required" dc:"书本ID"`</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> DelRes <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span></code></pre>
<p><strong>4. 控制器框架及路由绑定</strong></p>
<p><code>internal/controller/user/user.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> user

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"context"</span>
    <span class="token string">"gfbook/api/user"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> UserController <span class="token operator">=</span> <span class="token operator">&amp;</span>cUser<span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">type</span> cUser <span class="token keyword">struct</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>cUser<span class="token punctuation">)</span> <span class="token function">Login</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req <span class="token operator">*</span>user<span class="token punctuation">.</span>LoginReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>user<span class="token punctuation">.</span>LoginRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span></code></pre>
<p><code>internal/controller/book/book.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> book

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"context"</span>
    <span class="token string">"gfbook/api/book"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> BookController <span class="token operator">=</span> <span class="token operator">&amp;</span>cBook<span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">type</span> cBook <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>cBook<span class="token punctuation">)</span> <span class="token function">Index</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req <span class="token operator">*</span>book<span class="token punctuation">.</span>IndexReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>book<span class="token punctuation">.</span>IndexRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>cBook<span class="token punctuation">)</span> <span class="token function">Add</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req <span class="token operator">*</span>book<span class="token punctuation">.</span>AddReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>book<span class="token punctuation">.</span>AddRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>cBook<span class="token punctuation">)</span> <span class="token function">Edit</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req <span class="token operator">*</span>book<span class="token punctuation">.</span>EditReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>book<span class="token punctuation">.</span>EditRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>cBook<span class="token punctuation">)</span> <span class="token function">Del</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req <span class="token operator">*</span>book<span class="token punctuation">.</span>DelReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>book<span class="token punctuation">.</span>EditRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span></code></pre>
<p><code>internal/cmd/cmd.go</code></p>
<pre><code class="fenced-code-block language-go">s <span class="token operator">:=</span> g<span class="token punctuation">.</span><span class="token function">Server</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>group <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>RouterGroup<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    group<span class="token punctuation">.</span><span class="token function">Middleware</span><span class="token punctuation">(</span>ghttp<span class="token punctuation">.</span>MiddlewareHandlerResponse<span class="token punctuation">)</span>
    group<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>group <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>RouterGroup<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        group<span class="token punctuation">.</span><span class="token function">Bind</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>UserController<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    group<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>group <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>RouterGroup<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        group<span class="token punctuation">.</span><span class="token function">Bind</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>BookController<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p><strong>5. 设计Book的Service接口并完善控制器</strong></p>
<p><code>internal/service/book.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> service

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"context"</span>
    <span class="token string">"gfbook/internal/model/do"</span>
    <span class="token string">"gfbook/internal/model/entity"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> IBook <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token comment">// 查询书本列表</span>
    <span class="token function">GetList</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> page <span class="token builtin">uint</span><span class="token punctuation">,</span> pageSize <span class="token builtin">uint</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>books <span class="token punctuation">[</span><span class="token punctuation">]</span>entity<span class="token punctuation">.</span>Book<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token comment">// 添加书本信息</span>
    <span class="token function">Add</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> book do<span class="token punctuation">.</span>Book<span class="token punctuation">)</span> <span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token comment">// 修改书本信息</span>
    <span class="token function">Edit</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> book do<span class="token punctuation">.</span>Book<span class="token punctuation">)</span> <span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span>
    <span class="token comment">// 删除书本信息</span>
    <span class="token function">Del</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> id <span class="token builtin">uint</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> localBook IBook

<span class="token keyword">func</span> <span class="token function">Book</span><span class="token punctuation">(</span><span class="token punctuation">)</span> IBook <span class="token punctuation">{</span>
    <span class="token keyword">if</span> localBook <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"IBook接口未实现或未注册"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> localBook
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">RegisterBook</span><span class="token punctuation">(</span>i IBook<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    localBook <span class="token operator">=</span> i
<span class="token punctuation">}</span></code></pre>
<p><code>internal/controller/book/book.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> book

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"context"</span>
    <span class="token string">"gfbook/api/book"</span>
    <span class="token string">"gfbook/internal/model/do"</span>
    <span class="token string">"gfbook/internal/service"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> BookController <span class="token operator">=</span> <span class="token operator">&amp;</span>cBook<span class="token punctuation">{</span>
    service<span class="token punctuation">:</span> service<span class="token punctuation">.</span><span class="token function">Book</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> cBook <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    service service<span class="token punctuation">.</span>IBook
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>cBook<span class="token punctuation">)</span> <span class="token function">Index</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req <span class="token operator">*</span>book<span class="token punctuation">.</span>IndexReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>book<span class="token punctuation">.</span>IndexRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    books<span class="token punctuation">,</span> err <span class="token operator">:=</span> service<span class="token punctuation">.</span><span class="token function">Book</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetList</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> req<span class="token punctuation">.</span>Page<span class="token punctuation">,</span> req<span class="token punctuation">.</span>PageSize<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        res <span class="token operator">=</span> <span class="token operator">&amp;</span>book<span class="token punctuation">.</span>IndexRes<span class="token punctuation">{</span>
            Page<span class="token punctuation">:</span>     req<span class="token punctuation">.</span>Page<span class="token punctuation">,</span>
            PageSize<span class="token punctuation">:</span> req<span class="token punctuation">.</span>PageSize<span class="token punctuation">,</span>
            Rows<span class="token punctuation">:</span>     books<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>cBook<span class="token punctuation">)</span> <span class="token function">Add</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req <span class="token operator">*</span>book<span class="token punctuation">.</span>AddReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>book<span class="token punctuation">.</span>AddRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    err <span class="token operator">=</span> c<span class="token punctuation">.</span>service<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> do<span class="token punctuation">.</span>Book<span class="token punctuation">{</span>
        Name<span class="token punctuation">:</span>        req<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
        Author<span class="token punctuation">:</span>      req<span class="token punctuation">.</span>Author<span class="token punctuation">,</span>
        Price<span class="token punctuation">:</span>       req<span class="token punctuation">.</span>Price<span class="token punctuation">,</span>
        PublishTime<span class="token punctuation">:</span> req<span class="token punctuation">.</span>PublishTime<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>cBook<span class="token punctuation">)</span> <span class="token function">Edit</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req <span class="token operator">*</span>book<span class="token punctuation">.</span>EditReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>book<span class="token punctuation">.</span>EditRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    err <span class="token operator">=</span> c<span class="token punctuation">.</span>service<span class="token punctuation">.</span><span class="token function">Edit</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> do<span class="token punctuation">.</span>Book<span class="token punctuation">{</span>
        Id<span class="token punctuation">:</span>          req<span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
        Name<span class="token punctuation">:</span>        req<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
        Author<span class="token punctuation">:</span>      req<span class="token punctuation">.</span>Author<span class="token punctuation">,</span>
        Price<span class="token punctuation">:</span>       req<span class="token punctuation">.</span>Price<span class="token punctuation">,</span>
        PublishTime<span class="token punctuation">:</span> req<span class="token punctuation">.</span>PublishTime<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>cBook<span class="token punctuation">)</span> <span class="token function">Del</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req <span class="token operator">*</span>book<span class="token punctuation">.</span>DelReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>book<span class="token punctuation">.</span>EditRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    err <span class="token operator">=</span> c<span class="token punctuation">.</span>service<span class="token punctuation">.</span><span class="token function">Del</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> req<span class="token punctuation">.</span>Id<span class="token punctuation">)</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>6. Logic层Book操作具体实现</strong></p>
<ul>
<li>新建<code>internal/logic/book/book.go</code>文件，实现上面的<code>IBook</code>接口</li>
</ul>
<p><code>internal/logic/book/book.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> book

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"context"</span>
    <span class="token string">"gfbook/internal/dao"</span>
    <span class="token string">"gfbook/internal/model/do"</span>
    <span class="token string">"gfbook/internal/model/entity"</span>
    <span class="token string">"gfbook/internal/service"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    service<span class="token punctuation">.</span><span class="token function">RegisterBook</span><span class="token punctuation">(</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>iBook <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>iBook<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> iBook <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// Add implements service.IBook.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>iBook<span class="token punctuation">)</span> <span class="token function">Add</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> book do<span class="token punctuation">.</span>Book<span class="token punctuation">)</span> <span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token comment">// Del implements service.IBook.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>iBook<span class="token punctuation">)</span> <span class="token function">Del</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> id <span class="token builtin">uint</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Id<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token comment">// Edit implements service.IBook.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>iBook<span class="token punctuation">)</span> <span class="token function">Edit</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> book do<span class="token punctuation">.</span>Book<span class="token punctuation">)</span> <span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">=</span> dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Id<span class="token punctuation">,</span> book<span class="token punctuation">.</span>Id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Data</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token comment">// GetList implements service.IBook.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>iBook<span class="token punctuation">)</span> <span class="token function">GetList</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> page <span class="token builtin">uint</span><span class="token punctuation">,</span> pageSize <span class="token builtin">uint</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>books <span class="token punctuation">[</span><span class="token punctuation">]</span>entity<span class="token punctuation">.</span>Book<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    err <span class="token operator">=</span> dao<span class="token punctuation">.</span>Book<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Page</span><span class="token punctuation">(</span><span class="token function">int</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">int</span><span class="token punctuation">(</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>books<span class="token punctuation">)</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span></code></pre>
<ul>
<li>新建<code>internal/logic/logic.go</code>文件，并对上述实现进行初始化导入</li>
</ul>
<pre><code class="fenced-code-block language-go"><span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token boolean">_</span> <span class="token string">"gfbook/internal/logic/book"</span>
<span class="token punctuation">)</span></code></pre>
<ul>
<li>在<code>main.go</code>中对logic进行初始化导入</li>
</ul>
<p><code>main.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token boolean">_</span> <span class="token string">"gfbook/internal/logic"</span>
<span class="token punctuation">)</span></code></pre>
<br>

<p><strong>7. User的Service层设计与控制器完善</strong></p>
<p><code>internal/service/user.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> service

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"context"</span>
    <span class="token string">"gfbook/internal/model/entity"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> IUser <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Login</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> username <span class="token builtin">string</span><span class="token punctuation">,</span> password <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>user <span class="token operator">*</span>entity<span class="token punctuation">.</span>User<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> localUser IUser

<span class="token keyword">func</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span> IUser <span class="token punctuation">{</span>
    <span class="token keyword">if</span> localUser <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"IUser接口未实现或未注册"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> localUser
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">RegisterUser</span><span class="token punctuation">(</span>i IUser<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    localUser <span class="token operator">=</span> i
<span class="token punctuation">}</span></code></pre>
<p><code>internal/controller/user/user.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> user

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"context"</span>
    api_user <span class="token string">"gfbook/api/user"</span>
    <span class="token string">"gfbook/internal/model/entity"</span>
    <span class="token string">"gfbook/internal/service"</span>
    <span class="token string">"time"</span>

    <span class="token string">"github.com/golang-jwt/jwt/v5"</span>
<span class="token punctuation">)</span>

<span class="token keyword">var</span> UserController <span class="token operator">=</span> <span class="token operator">&amp;</span>cUser<span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">type</span> cUser <span class="token keyword">struct</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>cUser<span class="token punctuation">)</span> <span class="token function">Login</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> req <span class="token operator">*</span>api_user<span class="token punctuation">.</span>LoginReq<span class="token punctuation">)</span> <span class="token punctuation">(</span>res <span class="token operator">*</span>api_user<span class="token punctuation">.</span>LoginRes<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    user<span class="token punctuation">,</span> err <span class="token operator">:=</span> service<span class="token punctuation">.</span><span class="token function">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Login</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> req<span class="token punctuation">.</span>Username<span class="token punctuation">,</span> req<span class="token punctuation">.</span>Password<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        res <span class="token operator">=</span> <span class="token operator">&amp;</span>api_user<span class="token punctuation">.</span>LoginRes<span class="token punctuation">{</span>
            Token<span class="token punctuation">:</span> <span class="token function">jwtToken</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">,</span>
            UserInfo<span class="token punctuation">:</span> <span class="token operator">&amp;</span>api_user<span class="token punctuation">.</span>UserInfo<span class="token punctuation">{</span>
                Id<span class="token punctuation">:</span>       user<span class="token punctuation">.</span>Id<span class="token punctuation">,</span>
                Username<span class="token punctuation">:</span> user<span class="token punctuation">.</span>Username<span class="token punctuation">,</span>
                Nickname<span class="token punctuation">:</span> user<span class="token punctuation">.</span>Nickname<span class="token punctuation">,</span>
                Avatar<span class="token punctuation">:</span>   user<span class="token punctuation">.</span>Avatar<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">jwtToken</span><span class="token punctuation">(</span>user <span class="token operator">*</span>entity<span class="token punctuation">.</span>User<span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>

    <span class="token keyword">const</span> JwtTokenKey <span class="token operator">=</span> <span class="token string">"zbvxMPp12fibPNnOaYmc0rviniaJCOVJ"</span>
    <span class="token comment">// 实际使用中可将Key存于文件中或放在常量中 consts.JwtTokenKey</span>

    claim <span class="token operator">:=</span> jwt<span class="token punctuation">.</span>RegisteredClaims<span class="token punctuation">{</span>
        Subject<span class="token punctuation">:</span>   user<span class="token punctuation">.</span>Username<span class="token punctuation">,</span>
        ExpiresAt<span class="token punctuation">:</span> jwt<span class="token punctuation">.</span><span class="token function">NewNumericDate</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Hour <span class="token operator">*</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    token<span class="token punctuation">,</span> err <span class="token operator">:=</span> jwt<span class="token punctuation">.</span><span class="token function">NewWithClaims</span><span class="token punctuation">(</span>jwt<span class="token punctuation">.</span>SigningMethodHS256<span class="token punctuation">,</span> claim<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SignedString</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>JwtTokenKey<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"token生成出错"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> token
<span class="token punctuation">}</span></code></pre>
<br>

<p><strong>8. User的Logic层实现</strong></p>
<p><code>internal/logic/user/user.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> user

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"context"</span>
    <span class="token string">"gfbook/internal/dao"</span>
    <span class="token string">"gfbook/internal/model/do"</span>
    <span class="token string">"gfbook/internal/model/entity"</span>
    <span class="token string">"gfbook/internal/service"</span>

    <span class="token string">"github.com/gogf/gf/v2/errors/gerror"</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> iUser <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>iUser <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>iUser<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    service<span class="token punctuation">.</span><span class="token function">RegisterUser</span><span class="token punctuation">(</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Login implements service.IUser.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>iUser<span class="token punctuation">)</span> <span class="token function">Login</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> username <span class="token builtin">string</span><span class="token punctuation">,</span> password <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>user <span class="token operator">*</span>entity<span class="token punctuation">.</span>User<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    err <span class="token operator">=</span> dao<span class="token punctuation">.</span>User<span class="token punctuation">.</span><span class="token function">Ctx</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>do<span class="token punctuation">.</span>User<span class="token punctuation">{</span>
        Username<span class="token punctuation">:</span> username<span class="token punctuation">,</span>
        Password<span class="token punctuation">:</span> password<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Scan</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>

    <span class="token keyword">if</span> user <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        err <span class="token operator">=</span> gerror<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"用户名或密码有误"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span></code></pre>
<p><code>internal/logic/logic.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token boolean">_</span> <span class="token string">"gfbook/internal/logic/book"</span>
    <span class="token boolean">_</span> <span class="token string">"gfbook/internal/logic/user"</span>
<span class="token punctuation">)</span></code></pre>
<br>

<p><strong>9. 添加登录验证中间件</strong></p>
<p><code>internal/service/middware.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> service

<span class="token keyword">import</span> <span class="token string">"github.com/gogf/gf/v2/net/ghttp"</span>

<span class="token keyword">type</span> IMiddleware <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Auth</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> localMiddleware IMiddleware

<span class="token keyword">func</span> <span class="token function">Middleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span> IMiddleware <span class="token punctuation">{</span>
    <span class="token keyword">if</span> localMiddleware <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"IMiddleware接口未实现或未注册"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> localMiddleware
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">RegisterMiddleware</span><span class="token punctuation">(</span>i IMiddleware<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    localMiddleware <span class="token operator">=</span> i
<span class="token punctuation">}</span></code></pre>
<p><code>internal/logic/middleware/middleware.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> middleware

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">"gfbook/internal/consts"</span>
    <span class="token string">"gfbook/internal/service"</span>

    <span class="token string">"github.com/gogf/gf/v2/net/ghttp"</span>
    <span class="token string">"github.com/golang-jwt/jwt/v5"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    service<span class="token punctuation">.</span><span class="token function">RegisterMiddleware</span><span class="token punctuation">(</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>iMiddleware <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>iMiddleware<span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> iMiddleware <span class="token keyword">struct</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token comment">// Auth implements service.IMiddleware.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span><span class="token operator">*</span>iMiddleware<span class="token punctuation">)</span> <span class="token function">Auth</span><span class="token punctuation">(</span>r <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> res <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>DefaultHandlerResponse
    tokenStr <span class="token operator">:=</span> r<span class="token punctuation">.</span>Header<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">"Authorization"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> tokenStr <span class="token operator">==</span> <span class="token string">""</span> <span class="token punctuation">{</span>
        res <span class="token operator">=</span> <span class="token operator">&amp;</span>ghttp<span class="token punctuation">.</span>DefaultHandlerResponse<span class="token punctuation">{</span>
            Code<span class="token punctuation">:</span>    <span class="token number">403</span><span class="token punctuation">,</span>
            Message<span class="token punctuation">:</span> <span class="token string">"请登录后携带token访问"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        token<span class="token punctuation">,</span> err <span class="token operator">:=</span> jwt<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>tokenStr<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>t <span class="token operator">*</span>jwt<span class="token punctuation">.</span>Token<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>consts<span class="token punctuation">.</span>JwtTokenKey<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token operator">||</span> <span class="token operator">!</span>token<span class="token punctuation">.</span>Valid <span class="token punctuation">{</span>
            res <span class="token operator">=</span> <span class="token operator">&amp;</span>ghttp<span class="token punctuation">.</span>DefaultHandlerResponse<span class="token punctuation">{</span>
                Code<span class="token punctuation">:</span>    <span class="token number">403</span><span class="token punctuation">,</span>
                Message<span class="token punctuation">:</span> <span class="token string">"token已失效，请重新登录"</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> res <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        r<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteJsonExit</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    r<span class="token punctuation">.</span>Middleware<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<p><code>internal/logic/logic.go</code></p>
<pre><code class="fenced-code-block language-go"><span class="token keyword">package</span> logic

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token boolean">_</span> <span class="token string">"gfbook/internal/logic/book"</span>
    <span class="token boolean">_</span> <span class="token string">"gfbook/internal/logic/middleware"</span>
    <span class="token boolean">_</span> <span class="token string">"gfbook/internal/logic/user"</span>
<span class="token punctuation">)</span></code></pre>
<p><code>internal/cmd/cmd.go</code></p>
<pre><code class="fenced-code-block language-go">group<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>group <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>RouterGroup<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    group<span class="token punctuation">.</span><span class="token function">Middleware</span><span class="token punctuation">(</span>service<span class="token punctuation">.</span><span class="token function">Middleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Auth<span class="token punctuation">)</span>
                    group<span class="token punctuation">.</span><span class="token function">Bind</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>BookController<span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<br>

<p><strong>10. 接口文档</strong></p>
<p>准备对应的JS与CSS文件放入静态资源对应的目录，或者可以用在线的CDN链接</p>
<p><code>template/api.html</code></p>
<pre><code class="fenced-code-block language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>IE=edge<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/resource/css/swagger-ui.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/resource/js/swagger-ui-bundle.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>API Doc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>swagger-ui<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    window<span class="token punctuation">.</span>ui <span class="token operator">=</span> <span class="token function">SwaggerUIBundle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/api.json'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">dom_id</span><span class="token operator">:</span> <span class="token string">'#swagger-ui'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><code>internal/cmd/cmd.go</code></p>
<pre><code class="fenced-code-block language-go">group<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">"/api"</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>req <span class="token operator">*</span>ghttp<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    req<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">WriteTpl</span><span class="token punctuation">(</span><span class="token string">"/api.html"</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<br>

<h1 class="atx" id="后续学习项目">后续学习项目</h1>
<p><a href="https://github.com/gogf/gf-demo-user">https://github.com/gogf/gf-demo-user</a></p>
<p><a href="https://github.com/gogf/focus-single">https://github.com/gogf/focus-single</a></p>
</article>

</body></html>